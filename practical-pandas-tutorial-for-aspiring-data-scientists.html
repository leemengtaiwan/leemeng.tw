<!DOCTYPE html>
<!--[if lt IE 9 ]><html class="no-js oldie" lang="zh-hant-tw"> <![endif]-->
<!--[if IE 9 ]><html class="no-js oldie ie9" lang="zh-hant-tw"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html class="no-js" lang="zh-hant-tw">
<!--<![endif]-->

<head>

    <!--- basic page needs
    ================================================== -->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="author" content="Lee Meng" />
<title>LeeMeng - 資料科學家的 pandas 實戰手冊：掌握 40 個實用數據技巧</title>
    <!--- article-specific meta data
    ================================================== -->
        <meta name="description" content="熟練地使用 pandas 是資料科學家處理數據與分析時不可或缺的重要技能之一。透過 40 個 pandas 實用技巧，這篇文章將帶你由淺入深地掌握最基礎且重要的 pandas 能力。文中也將介紹多個適合與 pandas 一起使用的強大函式庫，提升你的數據處理能力。" />
        <meta name="keywords" content="資料科學, Python, pandas" />
        <meta name="tags" content="資料科學" />
        <meta name="tags" content="Python" />
        <meta name="tags" content="pandas" />


    <!--- Open Graph Object metas
    ================================================== -->
        <meta property="og:image" content="https://leemeng.tw/theme/images/background/nick-hillier-yD5rv8_WzxA-unsplash.jpg" />
        <meta property="og:type" content="article" />
        <meta property="og:url" content="https://leemeng.tw/practical-pandas-tutorial-for-aspiring-data-scientists.html" />
        <meta property="og:title" content="資料科學家的 pandas 實戰手冊：掌握 40 個實用數據技巧" />
        <meta property="og:description" content="熟練地使用 pandas 是資料科學家處理數據與分析時不可或缺的重要技能之一。透過 40 個 pandas 實用技巧，這篇文章將帶你由淺入深地掌握最基礎且重要的 pandas 能力。文中也將介紹多個適合與 pandas 一起使用的強大函式庫，提升你的數據處理能力。" />

    <!-- mobile specific metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS
    ================================================== -->
    <!--for customized css in individual page-->
        <link rel="stylesheet" type="text/css" href="https://leemeng.tw/theme/css/bootstrap.min.css">

    <!--for showing toc navigation which slide in from left-->
        <link rel="stylesheet" type="text/css" href="https://leemeng.tw/theme/css/toc-nav.css">

    <!--for responsive embed youtube video-->
        <link rel="stylesheet" type="text/css" href="https://leemeng.tw/theme/css/embed_youtube.css">

    <!--for prettify dark-mode result-->
        <link rel="stylesheet" type="text/css" href="https://leemeng.tw/theme/css/darkmode.css">

    <link rel="stylesheet" type="text/css" href="https://leemeng.tw/theme/css/base.css">
    <link rel="stylesheet" type="text/css" href="https://leemeng.tw/theme/css/vendor.css">
    <link rel="stylesheet" type="text/css" href="https://leemeng.tw/theme/css/main.css">
    <link rel="stylesheet" type="text/css" href="https://leemeng.tw/theme/css/ipython.css">
    <link rel="stylesheet" type="text/css" href='https://leemeng.tw/theme/css/progress-bar.css' />


    <!--TiqueSearch-->
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400">
    <link rel="stylesheet" href="https://leemeng.tw/theme/tipuesearch/css/normalize.css">
    <link rel="stylesheet" href="https://leemeng.tw/theme/tipuesearch/css/tipuesearch.css">

    <!-- script
    ================================================== -->
    <script src="https://leemeng.tw/theme/js/modernizr.js"></script>
    <script src="https://leemeng.tw/theme/js/pace.min.js"></script>


    <!-- favicons
    ================================================== -->
    <link rel="shortcut icon" href="../theme/images/favicon.ico" type="image/x-icon"/>
    <link rel="icon" href="../theme/images/favicon.ico" type="image/x-icon"/>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106559980-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-106559980-1');
</script>



</head>


<body id="top">

    <!-- header
    ================================================== -->
    <header class="s-header">

        <div class="header-logo">
            <a class="site-logo" href="../index.html"><img src="https://leemeng.tw/theme/images/logo.png" alt="Homepage"></a>
        </div>
<!--navigation bar ref: http://jinja.pocoo.org/docs/2.10/tricks/-->



<nav class="header-nav-wrap">
    <ul class="header-nav">
        <li>
            <a href="../index.html#home">Home</a>
        </li>
        <li>
            <a href="../index.html#about">About</a>
        </li>
        <li>
            <a href="../index.html#projects">Projects</a>
        </li>
        <li class="current">
            <a href="../blog.html">Blog</a>
        </li>
        <li>
            <a href="https://demo.leemeng.tw">Demo</a>
        </li>
        <li>
            <a href="../books.html">Books</a>
        </li>
        <li>
            <a href="../index.html#contact">Contact</a>
        </li>

    </ul>

    <!--<div class="search-container">-->
        <!--<form action="../search.html">-->
            <!--<input type="text" placeholder="Search.." name="search">-->
            <!--<button type="submit"><i class="im im-magnifier" aria-hidden="true"></i></button>-->
        <!--</form>-->
    <!--</div>-->

</nav>
        <a class="header-menu-toggle" href="#0"><span>Menu</span></a>

    </header> <!-- end s-header -->



    <!--TOC navigation displayed when clicked from left-navigation button-->
    <div id="tocNav" class="overlay" onclick="closeTocNav()">
      <div class="overlay-content">
        <div id="toc"><ul><li><a class="toc-href" href="#" title="資料科學家的 pandas 實戰手冊：掌握 40 個實用數據技巧">資料科學家的 pandas 實戰手冊：掌握 40 個實用數據技巧</a><ul><li><a class="toc-href" href="#建立-DataFrame" title="建立 DataFrame">建立 DataFrame</a><ul><li><a class="toc-href" href="#用-Python-dict-建立-DataFrame" title="用 Python dict 建立 DataFrame">用 Python dict 建立 DataFrame</a></li><li><a class="toc-href" href="#使用-pd.util.testing-隨機建立-DataFrame" title="使用 pd.util.testing 隨機建立 DataFrame">使用 pd.util.testing 隨機建立 DataFrame</a></li><li><a class="toc-href" href="#將剪貼簿內容轉換成-DataFrame" title="將剪貼簿內容轉換成 DataFrame">將剪貼簿內容轉換成 DataFrame</a></li><li><a class="toc-href" href="#讀取線上-CSV-檔" title="讀取線上 CSV 檔">讀取線上 CSV 檔</a></li><li><a class="toc-href" href="#優化記憶體使用量" title="優化記憶體使用量">優化記憶體使用量</a></li><li><a class="toc-href" href="#讀入並合併多個-CSV-檔案成單一-DataFrame" title="讀入並合併多個 CSV 檔案成單一 DataFrame">讀入並合併多個 CSV 檔案成單一 DataFrame</a></li></ul></li><li><a class="toc-href" href="#客製化-DataFrame-顯示設定_1" title="客製化 DataFrame 顯示設定">客製化 DataFrame 顯示設定</a><ul><li><a class="toc-href" href="#完整顯示所有欄位" title="完整顯示所有欄位">完整顯示所有欄位</a></li><li><a class="toc-href" href="#減少顯示的欄位長度" title="減少顯示的欄位長度">減少顯示的欄位長度</a></li><li><a class="toc-href" href="#改變浮點數顯示位數" title="改變浮點數顯示位數">改變浮點數顯示位數</a></li><li><a class="toc-href" href="#為特定-DataFrame-加點樣式" title="為特定 DataFrame 加點樣式">為特定 DataFrame 加點樣式</a></li></ul></li><li><a class="toc-href" href="#數據清理-&amp;-整理_1" title="數據清理 &amp; 整理">數據清理 &amp; 整理</a><ul><li><a class="toc-href" href="#處理空值" title="處理空值">處理空值</a></li><li><a class="toc-href" href="#捨棄不需要的行列" title="捨棄不需要的行列">捨棄不需要的行列</a></li><li><a class="toc-href" href="#重置並捨棄索引" title="重置並捨棄索引">重置並捨棄索引</a></li><li><a class="toc-href" href="#將字串切割成多個欄位" title="將字串切割成多個欄位">將字串切割成多個欄位</a></li><li><a class="toc-href" href="#將-list-分成多個欄位" title="將 list 分成多個欄位">將 list 分成多個欄位</a></li></ul></li><li><a class="toc-href" href="#取得想要關注的數據_1" title="取得想要關注的數據">取得想要關注的數據</a><ul><li><a class="toc-href" href="#基本數據切割" title="基本數據切割">基本數據切割</a></li><li><a class="toc-href" href="#反向選取行列" title="反向選取行列">反向選取行列</a></li><li><a class="toc-href" href="#條件選取數據" title="條件選取數據">條件選取數據</a></li><li><a class="toc-href" href="#選擇任一欄有空值的樣本" title="選擇任一欄有空值的樣本">選擇任一欄有空值的樣本</a></li><li><a class="toc-href" href="#選取或排除特定類型欄位" title="選取或排除特定類型欄位">選取或排除特定類型欄位</a></li><li><a class="toc-href" href="#選取所有出現在-list-內的樣本" title="選取所有出現在 list 內的樣本">選取所有出現在 list 內的樣本</a></li><li><a class="toc-href" href="#選取某欄位為-top-k-值的樣本" title="選取某欄位為 top-k 值的樣本">選取某欄位為 top-k 值的樣本</a></li><li><a class="toc-href" href="#找出符合特定字串的樣本" title="找出符合特定字串的樣本">找出符合特定字串的樣本</a></li><li><a class="toc-href" href="#使用正規表示式選取數據" title="使用正規表示式選取數據">使用正規表示式選取數據</a></li><li><a class="toc-href" href="#選取從某時間點開始的區間樣本" title="選取從某時間點開始的區間樣本">選取從某時間點開始的區間樣本</a></li></ul></li><li><a class="toc-href" href="#基本數據處理與轉換_1" title="基本數據處理與轉換">基本數據處理與轉換</a><ul><li><a class="toc-href" href="#對某一軸套用相同運算" title="對某一軸套用相同運算">對某一軸套用相同運算</a></li><li><a class="toc-href" href="#對每一個樣本做自定義運算" title="對每一個樣本做自定義運算">對每一個樣本做自定義運算</a></li><li><a class="toc-href" href="#將連續數值轉換成分類數據" title="將連續數值轉換成分類數據">將連續數值轉換成分類數據</a></li><li><a class="toc-href" href="#將-DataFrame-隨機切成兩個子集" title="將 DataFrame 隨機切成兩個子集">將 DataFrame 隨機切成兩個子集</a></li><li><a class="toc-href" href="#用-SQL-的方式合併兩個-DataFrames" title="用 SQL 的方式合併兩個 DataFrames">用 SQL 的方式合併兩個 DataFrames</a></li><li><a class="toc-href" href="#存取並操作每一個樣本" title="存取並操作每一個樣本">存取並操作每一個樣本</a></li></ul></li><li><a class="toc-href" href="#簡單匯總-&amp;-分析數據_1" title="簡單匯總 &amp; 分析數據">簡單匯總 &amp; 分析數據</a><ul><li><a class="toc-href" href="#取出某欄位-top-k-的值" title="取出某欄位 top k 的值">取出某欄位 top k 的值</a></li><li><a class="toc-href" href="#一行描述數值欄位" title="一行描述數值欄位">一行描述數值欄位</a></li><li><a class="toc-href" href="#找出欄位裡所有出現過的值" title="找出欄位裡所有出現過的值">找出欄位裡所有出現過的值</a></li><li><a class="toc-href" href="#分組匯總結果" title="分組匯總結果">分組匯總結果</a></li><li><a class="toc-href" href="#結合原始數據與匯總結果" title="結合原始數據與匯總結果">結合原始數據與匯總結果</a></li><li><a class="toc-href" href="#對時間數據做匯總" title="對時間數據做匯總">對時間數據做匯總</a></li><li><a class="toc-href" href="#簡易繪圖並修改預設樣式" title="簡易繪圖並修改預設樣式">簡易繪圖並修改預設樣式</a></li></ul></li><li><a class="toc-href" href="#與-pandas-相得益彰的實用工具_1" title="與 pandas 相得益彰的實用工具">與 pandas 相得益彰的實用工具</a><ul><li><a class="toc-href" href="#tqdm：了解你的數據處理進度" title="tqdm：了解你的數據處理進度">tqdm：了解你的數據處理進度</a></li><li><a class="toc-href" href="#swifter：加速你的數據處理" title="swifter：加速你的數據處理">swifter：加速你的數據處理</a></li><li><a class="toc-href" href="#qgrid：即時排序、篩選及編輯你的-DataFrame" title="qgrid：即時排序、篩選及編輯你的 DataFrame">qgrid：即時排序、篩選及編輯你的 DataFrame</a></li><li><a class="toc-href" href="#pandas-profiling：你的一鍵-EDA-神器" title="pandas-profiling：你的一鍵 EDA 神器">pandas-profiling：你的一鍵 EDA 神器</a></li></ul></li><li><a class="toc-href" href="#結語：實際運用所學_1" title="結語：實際運用所學">結語：實際運用所學</a></li></ul></li></ul></div>
      </div>
    </div>

    <!--custom images with icon shown on left nav-->
    <!--the details are set in `pelicanconf.py` as `LEFT_NAV_IMAGES`-->

    <article class="blog-single">

        <!-- page header/blog hero, use custom cover image if available
        ================================================== -->
            <div class="page-header page-header--single page-hero" style="background-image:url(https://leemeng.tw/theme/images/background/nick-hillier-yD5rv8_WzxA-unsplash.jpg)">

            <div class="row page-header__content narrow">
                <article class="col-full">
                    <div class="page-header__info">
                        <div class="page-header__cat">
                            <a href="https://leemeng.tw/tag/zi-liao-ke-xue.html" rel="tag">資料科學</a>
                            <a href="https://leemeng.tw/tag/python.html" rel="tag">Python</a>
                            <a href="https://leemeng.tw/tag/pandas.html" rel="tag">pandas</a>
                        </div>
                    </div>
                    <h1 class="page-header__title">
                        <a href="https://leemeng.tw/practical-pandas-tutorial-for-aspiring-data-scientists.html" title="">
                            資料科學家的 pandas 實戰手冊：掌握 40 個實用數據技巧
                        </a>
                    </h1>
                    <ul class="page-header__meta">
                        <li class="date">2019-07-27 (Sat)</li>
                        <li class="page-view">
                            152,679 views
                        </li>
                    </ul>

                </article>
            </div>

        </div> <!-- end page-header -->

        <div class="KW_progressContainer">
            <div class="KW_progressBar"></div>
        </div>

        <div class="row blog-content" style="position: relative">
<div id="left-navigation">

    <div id="search-wrap">
        <i class="im im-magnifier" aria-hidden="true"></i>
        <div id="search">
            <form action="../search.html">
            <div class="tipue_search_right"><input type="text" name="q" id="tipue_search_input" pattern=".{2,}" title="想搜尋什麼呢？（請至少輸入兩個字）" required></div>
            </form>
        </div>
    </div>

    <div id="toc-wrap">
        <a title="顯示/隱藏 文章章節">
            <i class="im im-menu" aria-hidden="true" onclick="toggleTocNav()"></i>
        </a>
    </div>

    <div id="social-wrap" style="cursor: pointer">
        <a class="open-popup" title="訂閱最新文章">
            <i class="im im-newspaper-o" aria-hidden="true"></i>
        </a>
    </div>
    <div id="social-wrap">
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//leemeng.tw/practical-pandas-tutorial-for-aspiring-data-scientists.html" target="_blank" title="分享到 Facebook">
            <i class="im im-facebook" aria-hidden="true"></i>
        </a>
    </div>
    <div id="social-wrap">
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A//leemeng.tw/practical-pandas-tutorial-for-aspiring-data-scientists.html&title=%E8%B3%87%E6%96%99%E7%A7%91%E5%AD%B8%E5%AE%B6%E7%9A%84%20pandas%20%E5%AF%A6%E6%88%B0%E6%89%8B%E5%86%8A%EF%BC%9A%E6%8E%8C%E6%8F%A1%2040%20%E5%80%8B%E5%AF%A6%E7%94%A8%E6%95%B8%E6%93%9A%E6%8A%80%E5%B7%A7&summary=%E7%86%9F%E7%B7%B4%E5%9C%B0%E4%BD%BF%E7%94%A8%20pandas%20%E6%98%AF%E8%B3%87%E6%96%99%E7%A7%91%E5%AD%B8%E5%AE%B6%E8%99%95%E7%90%86%E6%95%B8%E6%93%9A%E8%88%87%E5%88%86%E6%9E%90%E6%99%82%E4%B8%8D%E5%8F%AF%E6%88%96%E7%BC%BA%E7%9A%84%E9%87%8D%E8%A6%81%E6%8A%80%E8%83%BD%E4%B9%8B%E4%B8%80%E3%80%82%E9%80%8F%E9%81%8E%2040%20%E5%80%8B%20pandas%20%E5%AF%A6%E7%94%A8%E6%8A%80%E5%B7%A7%EF%BC%8C%E9%80%99%E7%AF%87%E6%96%87%E7%AB%A0%E5%B0%87%E5%B8%B6%E4%BD%A0%E7%94%B1%E6%B7%BA%E5%85%A5%E6%B7%B1%E5%9C%B0%E6%8E%8C%E6%8F%A1%E6%9C%80%E5%9F%BA%E7%A4%8E%E4%B8%94%E9%87%8D%E8%A6%81%E7%9A%84%20pandas%20%E8%83%BD%E5%8A%9B%E3%80%82%E6%96%87%E4%B8%AD%E4%B9%9F%E5%B0%87%E4%BB%8B%E7%B4%B9%E5%A4%9A%E5%80%8B%E9%81%A9%E5%90%88%E8%88%87%20pandas%20%E4%B8%80%E8%B5%B7%E4%BD%BF%E7%94%A8%E7%9A%84%E5%BC%B7%E5%A4%A7%E5%87%BD%E5%BC%8F%E5%BA%AB%EF%BC%8C%E6%8F%90%E5%8D%87%E4%BD%A0%E7%9A%84%E6%95%B8%E6%93%9A%E8%99%95%E7%90%86%E8%83%BD%E5%8A%9B%E3%80%82&source=https%3A//leemeng.tw/practical-pandas-tutorial-for-aspiring-data-scientists.html" target="_blank" title="分享到 LinkedIn">
            <i class="im im-linkedin" aria-hidden="true"></i>
        </a>
    </div>
    <div id="social-wrap">
        <a href="https://twitter.com/intent/tweet?text=%E8%B3%87%E6%96%99%E7%A7%91%E5%AD%B8%E5%AE%B6%E7%9A%84%20pandas%20%E5%AF%A6%E6%88%B0%E6%89%8B%E5%86%8A%EF%BC%9A%E6%8E%8C%E6%8F%A1%2040%20%E5%80%8B%E5%AF%A6%E7%94%A8%E6%95%B8%E6%93%9A%E6%8A%80%E5%B7%A7&url=https%3A//leemeng.tw/practical-pandas-tutorial-for-aspiring-data-scientists.html&hashtags=zi-liao-ke-xue,python,pandas" target="_blank" title="分享到 Twitter">
            <i class="im im-twitter" aria-hidden="true"></i>
        </a>
    </div>


    <!--custom images with icon shown on left nav-->

</div>

            <div class="col-full blog-content__main">

                <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>
                        故學然後知不足，教然後知困。知不足，然後能自反也；知困，然後能自強也，故曰：教學相長也。
                        <br/>
<span style="float:right;margin-right: 1.5rem">─ 《禮記．學記》</span>
<br/>
</p>
</blockquote>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://pandas.pydata.org/">pandas</a> 是 <a href="https://www.python.org/">Python</a> 的一個資料分析函式庫，提供如 <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">DataFrame</a> 等十分容易操作的資料結構，是近年做數據分析時不可或需的工具之一。</p>
<p>雖然已經有滿坑滿谷的教學文章、影片或是線上課程，正是因為 pandas 學習資源之多，導致初學者常常不知如何踏出第一步。在這篇文章裡頭，我以自身作為資料科學家（<strong>D</strong>ata <strong>S</strong>cientist, DS）的工作經驗，將接近 40 個實用的 pandas 技巧由淺入深地分成 6 大類別：</p>
<ol>
<li><a href="#建立-DataFrame">建立 DataFrame</a></li>
<li><a href="#客製化-DataFrame-顯示設定_1">客製化 DataFrame 顯示設定</a></li>
<li><a href="#數據清理-&amp;-整理_1">數據清理 &amp; 整理</a></li>
<li><a href="#取得想要關注的數據_1">取得想要關注的數據</a></li>
<li><a href="#基本數據處理與轉換_1">基本數據處理與轉換</a></li>
<li><a href="#簡單匯總-&amp;-分析數據_1">簡單匯總 &amp; 分析數據</a></li>
</ol>
<p>透過有系統地呈現這些 pandas 技巧，我希望能讓更多想要利用 Python 做資料分析或是想成為 DS 的你，能用最有效率的方式掌握核心 pandas 能力；同時也希望你能將自己認為實用但本文沒有提到的技巧與我分享，達到開頭引文所說的<strong>教學相長</strong>：）</p>
<p>如果你是使用寬螢幕瀏覽本文，隨時可以點擊左側傳送門瀏覽各章內容：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<video autoplay="" loop="" muted="" playsinline="" poster="https://leemeng.tw/images/pandas/toc_overview.jpg" style="mix-blend-mode: initial;">
<source src="https://leemeng.tw/images/pandas/toc_overview.mp4" type="video/mp4"/>
                    您的瀏覽器不支援影片標籤，請留言通知我：S
                </video>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>除了 pandas 的操作技巧以外，我在最後一節：<a href="#與-pandas-相得益彰的實用工具_1">與 pandas 相得益彰的實用工具</a>裡也介紹了幾個實用函式庫。就算你是 pandas 老手，或許也能從中得到些收穫。當然也非常歡迎與我分享其他厲害工具，我會更新到文章裡頭讓更多人知道。</p>
<p>前言已盡，讓我們開始這趟 pandas 旅程吧！當然，首先你得 <code>import pandas</code>：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>'0.24.2'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="建立-DataFrame">建立 DataFrame<a class="anchor-link" href="#建立-DataFrame">&para;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>pandas 裡有非常多種可以初始化一個 <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">DataFrame</a> 的技巧。以下列出一些我覺得實用的初始化方式。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="用-Python-dict-建立-DataFrame">用 Python dict 建立 DataFrame<a class="anchor-link" href="#用-Python-dict-建立-DataFrame">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>使用 Python 的 <code>dict</code> 來初始化 DataFrame 十分直覺。基本上 <code>dict</code> 裡頭的每一個鍵值（key）都對應到一個欄位名稱，而其值（value）則是一個 iterable，代表該欄位裡頭所有的數值。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dic</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"col 1"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> 
    <span class="s2">"col 2"</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="s2">"col 3"</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s1">'xyz'</span><span class="p">),</span>
    <span class="s2">"col 4"</span><span class="p">:</span> <span class="p">[</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">],</span>
    <span class="s2">"col 5"</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>col 1</th>
<th>col 2</th>
<th>col 3</th>
<th>col 4</th>
<th>col 5</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>10</td>
<td>x</td>
<td>a</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>20</td>
<td>y</td>
<td>b</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>30</td>
<td>z</td>
<td>c</td>
<td>2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在需要管理多個 DataFrames 時你會想要用更有意義的名字來代表它們，但在資料科學領域裡只要看到 <code>df</code>，每個人都會預期它是一個 <strong>D</strong>ata<strong>F</strong>rame，不論是 Python 或是 R 語言的使用者。</p>
<p>很多時候你也會需要改變 DataFrame 裡的欄位名稱：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">rename_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"col 1"</span><span class="p">:</span> <span class="s2">"x"</span><span class="p">,</span> <span class="s2">"col 2"</span><span class="p">:</span> <span class="s2">"10x"</span><span class="p">}</span>
<span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">rename_dic</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>x</th>
<th>10x</th>
<th>col 3</th>
<th>col 4</th>
<th>col 5</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>10</td>
<td>x</td>
<td>a</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>20</td>
<td>y</td>
<td>b</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>30</td>
<td>z</td>
<td>c</td>
<td>2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>這邊也很直覺，就是給一個將舊欄位名對應到新欄位名的 Python <code>dict</code>。值得注意的是參數 <code>axis=1</code>：在 pandas 裡大部分函式預設處理的軸為列（row）：以 <code>axis=0</code> 表示；而將 <code>axis</code> 設置為 <code>1</code> 則代表你想以行（column）為單位套用該函式。</p>
<p>你也可以用 <code>df.columns</code> 的方式改欄位名稱：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'x(new)'</span><span class="p">,</span> <span class="s1">'10x(new)'</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>x(new)</th>
<th>10x(new)</th>
<th>col 3</th>
<th>col 4</th>
<th>col 5</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>10</td>
<td>x</td>
<td>a</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>20</td>
<td>y</td>
<td>b</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>30</td>
<td>z</td>
<td>c</td>
<td>2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="使用-pd.util.testing-隨機建立-DataFrame">使用 pd.util.testing 隨機建立 DataFrame<a class="anchor-link" href="#使用-pd.util.testing-隨機建立-DataFrame">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>當你想要隨意初始化一個 DataFrame 並測試 pandas 功能時，<code>pd.util.testing</code> 就顯得十分好用：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">makeDataFrame</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>xPlIXbQqGU</th>
<td>1.086581</td>
<td>-0.002484</td>
<td>-0.335693</td>
<td>0.226988</td>
</tr>
<tr>
<th>IAFe6K8mpA</th>
<td>-0.547556</td>
<td>-0.290935</td>
<td>-0.014313</td>
<td>-0.301007</td>
</tr>
<tr>
<th>OoATGY0k2M</th>
<td>1.017636</td>
<td>0.568835</td>
<td>-0.272382</td>
<td>0.659657</td>
</tr>
<tr>
<th>uRN2yGacDw</th>
<td>-0.662390</td>
<td>1.929820</td>
<td>-1.206670</td>
<td>0.250626</td>
</tr>
<tr>
<th>ElphZli9nK</th>
<td>-0.697235</td>
<td>0.942415</td>
<td>-0.894887</td>
<td>0.701790</td>
</tr>
<tr>
<th>oiEoCPCXK8</th>
<td>-1.049284</td>
<td>-1.019107</td>
<td>-0.640271</td>
<td>-0.613056</td>
</tr>
<tr>
<th>NUrQFrYQw1</th>
<td>0.759355</td>
<td>0.717367</td>
<td>-0.449368</td>
<td>1.889321</td>
</tr>
<tr>
<th>oC9iiEBneW</th>
<td>0.665412</td>
<td>-0.391204</td>
<td>-0.974010</td>
<td>0.248326</td>
</tr>
<tr>
<th>4hD6Eea7yF</th>
<td>-0.862819</td>
<td>2.092149</td>
<td>0.976645</td>
<td>-0.388735</td>
</tr>
<tr>
<th>3QD5mMfstw</th>
<td>-0.312762</td>
<td>-0.110278</td>
<td>1.162421</td>
<td>-0.335144</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>head</code> 函式預設用來顯示 DataFrame 中前 5 筆數據。要顯示後面數據則可以使用 <code>tail</code> 函式。</p>
<p>你也可以用 <code>makeMixedDataFrame</code> 建立一個有各種資料型態的 DataFrame 方便測試：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">makeMixedDataFrame</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0.0</td>
<td>0.0</td>
<td>foo1</td>
<td>2009-01-01</td>
</tr>
<tr>
<th>1</th>
<td>1.0</td>
<td>1.0</td>
<td>foo2</td>
<td>2009-01-02</td>
</tr>
<tr>
<th>2</th>
<td>2.0</td>
<td>0.0</td>
<td>foo3</td>
<td>2009-01-05</td>
</tr>
<tr>
<th>3</th>
<td>3.0</td>
<td>1.0</td>
<td>foo4</td>
<td>2009-01-06</td>
</tr>
<tr>
<th>4</th>
<td>4.0</td>
<td>0.0</td>
<td>foo5</td>
<td>2009-01-07</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>其他函式如 <code>makeMissingDataframe</code> 及 <code>makeTimeDataFrame</code> 在後面的章節都還會看到。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="將剪貼簿內容轉換成-DataFrame">將剪貼簿內容轉換成 DataFrame<a class="anchor-link" href="#將剪貼簿內容轉換成-DataFrame">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你可以從 Excel、Google Sheet 或是網頁上複製表格並將其轉成 DataFrame。</p>
<p>簡單 2 步驟：</p>
<ul>
<li>複製其他來源的表格</li>
<li>執行 <code>pd.read_clipboard</code></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<video autoplay="" loop="" muted="" playsinline="" poster="https://leemeng.tw/images/pandas/pandas_clipboard.jpg" style="mix-blend-mode: initial;">
<source src="https://leemeng.tw/images/pandas/pandas_clipboard.mp4" type="video/mp4"/>
                    您的瀏覽器不支援影片標籤，請留言通知我：S
                </video>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>這個技巧在你想要快速將一些數據轉成 DataFrame 時非常方便。當然，你得考量重現性（reproducibility）。</p>
<p>為了讓未來的自己以及他人可以重現你當下的結果，必要時記得另存新檔以供後人使用：</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"some_data.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="讀取線上-CSV-檔">讀取線上 CSV 檔<a class="anchor-link" href="#讀取線上-CSV-檔">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>不限於本地檔案，只要有正確的 URL 以及網路連線就可以將網路上的任意 CSV 檔案轉成 DataFrame。</p>
<p>比方說你可以將 Kaggle 著名的<a href="https://www.kaggle.com/c/titanic">鐵達尼號競賽</a>的 CSV 檔案從網路上下載下來並轉成 DataFrame：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'http://bit.ly/kaggletrain'</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Name</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>0</td>
<td>3</td>
<td>Braund, Mr. Owen Harris</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>1</td>
<td>1</td>
<td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>1</td>
<td>3</td>
<td>Heikkinen, Miss. Laina</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>1</td>
<td>1</td>
<td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>Allen, Mr. William Henry</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>以下則是另個使用 pandas 爬取網路上數據並作分析的真實案例。</p>
<p>我在之前的<a href="https://leemeng.tw/chartify-a-simple-yet-powerful-python-data-visualization-tool-which-boost-your-productivity-as-a-data-scientist.html"> Chartify 教學文</a>中從臺北市的資料開放平台爬取<a href="https://data.taipei/#/dataset/detail?id=2f238b4f-1b27-4085-93e9-d684ef0e2735"> A1 及 A2 類交通事故數據</a>後做了簡單匯總：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 你可以用類似的方式爬取任何網路上的公開數據集</span>
<span class="n">base_url</span> <span class="o">=</span> <span class="s2">"https://data.taipei/api/getDatasetInfo/downloadResource?id=</span><span class="si">{}</span><span class="s2">&amp;rid=</span><span class="si">{}</span><span class="s2">"</span>
<span class="n">_id</span> <span class="o">=</span> <span class="s2">"2f238b4f-1b27-4085-93e9-d684ef0e2735"</span>
<span class="n">rid</span> <span class="o">=</span> <span class="s2">"ea731a84-e4a1-4523-b981-b733beddbc1f"</span>
<span class="n">csv_url</span> <span class="o">=</span> <span class="n">base_url</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_id</span><span class="p">,</span> <span class="n">rid</span><span class="p">)</span>
<span class="n">df_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_url</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'big5'</span><span class="p">)</span>

<span class="c1"># 複製一份做處理</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># 計算不同區不同性別的死亡、受傷人數</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'區序'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'區序'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()]))</span>
<span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'性別'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])]</span>
      <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'區序'</span><span class="p">,</span> <span class="s1">'性別'</span><span class="p">])[[</span><span class="s1">'死亡人數'</span><span class="p">,</span> <span class="s1">'受傷人數'</span><span class="p">]]</span>
      <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
      <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
      <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'受傷人數'</span><span class="p">))</span>

<span class="n">df</span><span class="p">[</span><span class="s1">'性別'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'性別'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">'男性'</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">'女性'</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'index'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 顯示結果</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_raw</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>發生年</th>
<th>發生月</th>
<th>發生日</th>
<th>發生時</th>
<th>發生分</th>
<th>處理別</th>
<th>區序</th>
<th>肇事地點</th>
<th>死亡人數</th>
<th>受傷人數</th>
<th>當事人序</th>
<th>車種</th>
<th>性別</th>
<th>年齡</th>
<th>受傷程度</th>
<th>4天候</th>
<th>7速限</th>
<th>8道路型態</th>
<th>9事故位置</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>107</td>
<td>3</td>
<td>29</td>
<td>15</td>
<td>54</td>
<td>2</td>
<td>01大同區</td>
<td>大同區民權西路108號</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>B03</td>
<td>2</td>
<td>41.0</td>
<td>3.0</td>
<td>8</td>
<td>50</td>
<td>14.0</td>
<td>9.0</td>
</tr>
<tr>
<th>1</th>
<td>107</td>
<td>3</td>
<td>29</td>
<td>15</td>
<td>54</td>
<td>2</td>
<td>01大同區</td>
<td>大同區民權西路108號</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>C03</td>
<td>2</td>
<td>58.0</td>
<td>2.0</td>
<td>8</td>
<td>50</td>
<td>14.0</td>
<td>9.0</td>
</tr>
<tr>
<th>2</th>
<td>107</td>
<td>1</td>
<td>7</td>
<td>17</td>
<td>42</td>
<td>2</td>
<td>01大同區</td>
<td>大同區重慶北路2段與南京西路口</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>B01</td>
<td>1</td>
<td>59.0</td>
<td>3.0</td>
<td>6</td>
<td>40</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr>
<th>3</th>
<td>107</td>
<td>1</td>
<td>7</td>
<td>17</td>
<td>42</td>
<td>2</td>
<td>01大同區</td>
<td>大同區重慶北路3段與南京西路口</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>C03</td>
<td>1</td>
<td>18.0</td>
<td>2.0</td>
<td>6</td>
<td>40</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr>
<th>4</th>
<td>107</td>
<td>1</td>
<td>14</td>
<td>9</td>
<td>56</td>
<td>2</td>
<td>01大同區</td>
<td>大同區承德路3段與民族西路口</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>C03</td>
<td>1</td>
<td>20.0</td>
<td>2.0</td>
<td>8</td>
<td>50</td>
<td>4.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>區序</th>
<th>性別</th>
<th>死亡人數</th>
<th>受傷人數</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>南港區</td>
<td>女性</td>
<td>2</td>
<td>799</td>
</tr>
<tr>
<th>1</th>
<td>萬華區</td>
<td>女性</td>
<td>2</td>
<td>1084</td>
</tr>
<tr>
<th>2</th>
<td>松山區</td>
<td>女性</td>
<td>30</td>
<td>1146</td>
</tr>
<tr>
<th>3</th>
<td>大同區</td>
<td>女性</td>
<td>3</td>
<td>1336</td>
</tr>
<tr>
<th>4</th>
<td>士林區</td>
<td>女性</td>
<td>3</td>
<td>1660</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>有了匯總過後的 DataFrame，你可以用後面<a href="#簡易繪圖並修改預設樣式">簡易繪圖並修改預設樣式</a>章節提到的 pandas <code>plot</code> 函式繪圖。但在這邊讓我用 <a href="https://leemeng.tw/chartify-a-simple-yet-powerful-python-data-visualization-tool-which-boost-your-productivity-as-a-data-scientist.html">Chartify</a> 展示結果：</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chartify</span>
<span class="n">ch</span> <span class="o">=</span> <span class="n">chartify</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">x_axis_type</span><span class="o">=</span><span class="s1">'categorical'</span><span class="p">,</span> 
    <span class="n">y_axis_type</span><span class="o">=</span><span class="s1">'categorical'</span><span class="p">)</span>

<span class="n">ch</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
    <span class="n">data_frame</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> 
    <span class="n">y_column</span><span class="o">=</span><span class="s1">'性別'</span><span class="p">,</span> 
    <span class="n">x_column</span><span class="o">=</span><span class="s1">'區序'</span><span class="p">,</span> 
    <span class="n">color_column</span><span class="o">=</span><span class="s1">'受傷人數'</span><span class="p">,</span> 
    <span class="n">text_column</span><span class="o">=</span><span class="s1">'受傷人數'</span><span class="p">,</span> 
    <span class="n">color_palette</span><span class="o">=</span><span class="s1">'Reds'</span><span class="p">,</span> 
    <span class="n">text_format</span><span class="o">=</span><span class="s1">'</span><span class="si">{:,.0f}</span><span class="s1">'</span><span class="p">)</span>

<span class="p">(</span><span class="n">ch</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'2017 年台北市各行政區交通意外受傷人數'</span><span class="p">)</span>
 <span class="o">.</span><span class="n">set_subtitle</span><span class="p">(</span><span class="s1">'性別分計'</span><span class="p">)</span>
 <span class="o">.</span><span class="n">set_source_label</span><span class="p">(</span><span class="s2">"Data.Taipei"</span><span class="p">)</span>
 <span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xaxis_label</span><span class="p">(</span><span class="s1">'性別'</span><span class="p">)</span>
 <span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_yaxis_label</span><span class="p">(</span><span class="s1">'行政區'</span><span class="p">)</span>
 <span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">'png'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<img src="https://leemeng.tw/images/pandas/read_csv_and_render_using_chartify.png"/>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>過來人經驗。雖然像這樣利用 pandas 直接從網路上下載並分析數據很方便，有時 host 數據的網頁與機構（尤其是政府機關）會無預期地修改他們網站，導致數據集的 URL 失效（苦主）。為了最大化重現性，我還是會建議將數據載到本地備份之後，再做分析比較實在。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="優化記憶體使用量">優化記憶體使用量<a class="anchor-link" href="#優化記憶體使用量">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你可以透過 <code>df.info</code> 查看 DataFrame 當前的記憶體用量：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">memory_usage</span><span class="o">=</span><span class="s2">"deep"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
PassengerId    891 non-null int64
Survived       891 non-null int64
Pclass         891 non-null int64
Name           891 non-null object
Sex            891 non-null object
Age            714 non-null float64
SibSp          891 non-null int64
Parch          891 non-null int64
Ticket         891 non-null object
Fare           891 non-null float64
Cabin          204 non-null object
Embarked       889 non-null object
dtypes: float64(2), int64(5), object(5)
memory usage: 322.0 KB
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>從最後一列可以看出鐵達尼號這個小 DataFrame 只佔了 322 KB。如果你是透過 <a href="https://jupyter.org/">Jupyter 筆記本</a>來操作 pandas，也可以考慮用 <a href="https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/varInspector/README.html">Variable Inspector</a> 插件來觀察包含 DataFrame 等變數的大小：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<video autoplay="" loop="" muted="" playsinline="" poster="https://leemeng.tw/20190721_practical_pandas_tutorial_for_aspiring_data_scientists.ipynb" style="mix-blend-mode: initial;">
<source src="https://leemeng.tw/images/pandas/variable_inspector.mp4" type="video/mp4"/>
                    您的瀏覽器不支援影片標籤，請留言通知我：S
                </video>
<center>
                        Variable Inspector
                        <br/>
<br/>
</center>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>這邊使用的 <code>df</code> 不佔什麼記憶體，但如果你想讀入的 DataFrame 很大，可以只讀入特定的欄位並將已知的分類型（categorical）欄位轉成 <code>category</code> 型態以節省記憶體（在分類數目較數據量小時有效）：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dtypes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"Embarked"</span><span class="p">:</span> <span class="s2">"category"</span><span class="p">}</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'PassengerId'</span><span class="p">,</span> <span class="s1">'Name'</span><span class="p">,</span> <span class="s1">'Sex'</span><span class="p">,</span> <span class="s1">'Embarked'</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'http://bit.ly/kaggletrain'</span><span class="p">,</span> 
                 <span class="n">dtype</span><span class="o">=</span><span class="n">dtypes</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">memory_usage</span><span class="o">=</span><span class="s2">"deep"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 4 columns):
PassengerId    891 non-null int64
Name           891 non-null object
Sex            891 non-null object
Embarked       889 non-null category
dtypes: category(1), int64(1), object(2)
memory usage: 134.9 KB
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>透過減少讀入的欄位數並將 <code>object</code> 轉換成 <code>category</code> 欄位，讀入的 <code>df</code> 只剩 135 KB。只需剛剛的 40 % 記憶體用量。</p>
<p>另外如果你想在有限的記憶體內處理巨大 CSV 檔案，也可以透過 <code>chunksize</code> 參數來限制一次讀入的列數（rows）：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="c1"># chunksize=4 表示一次讀入 4 筆樣本</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'dataset/titanic-train.csv'</span><span class="p">,</span> 
                     <span class="n">chunksize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
<span class="c1"># 秀出前兩個 chunks</span>
<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">df_partial</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">reader</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">df_partial</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Name</th>
<th>Sex</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>Braund, Mr. Owen Harris</td>
<td>male</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
<td>female</td>
<td>C</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>Heikkinen, Miss. Laina</td>
<td>female</td>
<td>S</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td>female</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Name</th>
<th>Sex</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>4</th>
<td>5</td>
<td>Allen, Mr. William Henry</td>
<td>male</td>
<td>S</td>
</tr>
<tr>
<th>5</th>
<td>6</td>
<td>Moran, Mr. James</td>
<td>male</td>
<td>Q</td>
</tr>
<tr>
<th>6</th>
<td>7</td>
<td>McCarthy, Mr. Timothy J</td>
<td>male</td>
<td>S</td>
</tr>
<tr>
<th>7</th>
<td>8</td>
<td>Palsson, Master. Gosta Leonard</td>
<td>male</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="讀入並合併多個-CSV-檔案成單一-DataFrame">讀入並合併多個 CSV 檔案成單一 DataFrame<a class="anchor-link" href="#讀入並合併多個-CSV-檔案成單一-DataFrame">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>很多時候因為企業內部 ETL 或是數據處理的方式（比方說<a href="https://leemeng.tw/a-story-about-airflow-and-data-engineering-using-how-to-use-python-to-catch-up-with-latest-comics-as-an-example.html">利用 Airflow 處理批次數據</a>），相同類型的數據可能會被分成多個不同的 CSV 檔案儲存。</p>
<p>假設在本地端 <code>dataset</code> 資料夾內有 2 個 CSV 檔案，分別儲存鐵達尼號上不同乘客的數據：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"dataset/passenger1.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Name</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>Allen</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>6</td>
<td>0</td>
<td>3</td>
<td>Moran</td>
<td>male</td>
<td>NaN</td>
<td>0</td>
<td>0</td>
<td>330877</td>
<td>8.4583</td>
<td>NaN</td>
<td>Q</td>
</tr>
<tr>
<th>2</th>
<td>7</td>
<td>0</td>
<td>1</td>
<td>McCarthy</td>
<td>male</td>
<td>54.0</td>
<td>0</td>
<td>0</td>
<td>17463</td>
<td>51.8625</td>
<td>E46</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>另外一個 CSV 內容：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"dataset/passenger2.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Name</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>13</td>
<td>0</td>
<td>3</td>
<td>Saundercock</td>
<td>male</td>
<td>20.0</td>
<td>0</td>
<td>0</td>
<td>A/5. 2151</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>14</td>
<td>0</td>
<td>3</td>
<td>Andersson</td>
<td>male</td>
<td>39.0</td>
<td>1</td>
<td>5</td>
<td>347082</td>
<td>31.2750</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>2</th>
<td>15</td>
<td>0</td>
<td>3</td>
<td>Vestrom</td>
<td>female</td>
<td>14.0</td>
<td>0</td>
<td>0</td>
<td>350406</td>
<td>7.8542</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>注意上面 2 個 DataFrames 的內容雖然分別代表不同乘客，其格式卻是一模一樣。這種時候你可以使用 <code>pd.concat</code> 將分散在不同 CSV 的乘客數據合併成單一 DataFrame，方便之後處理：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s2">"dataset/passenger*.csv"</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Name</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>Allen</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>6</td>
<td>0</td>
<td>3</td>
<td>Moran</td>
<td>male</td>
<td>NaN</td>
<td>0</td>
<td>0</td>
<td>330877</td>
<td>8.4583</td>
<td>NaN</td>
<td>Q</td>
</tr>
<tr>
<th>2</th>
<td>7</td>
<td>0</td>
<td>1</td>
<td>McCarthy</td>
<td>male</td>
<td>54.0</td>
<td>0</td>
<td>0</td>
<td>17463</td>
<td>51.8625</td>
<td>E46</td>
<td>S</td>
</tr>
<tr>
<th>3</th>
<td>13</td>
<td>0</td>
<td>3</td>
<td>Saundercock</td>
<td>male</td>
<td>20.0</td>
<td>0</td>
<td>0</td>
<td>A/5. 2151</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>4</th>
<td>14</td>
<td>0</td>
<td>3</td>
<td>Andersson</td>
<td>male</td>
<td>39.0</td>
<td>1</td>
<td>5</td>
<td>347082</td>
<td>31.2750</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>5</th>
<td>15</td>
<td>0</td>
<td>3</td>
<td>Vestrom</td>
<td>female</td>
<td>14.0</td>
<td>0</td>
<td>0</td>
<td>350406</td>
<td>7.8542</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你還可以使用 <code>reset_index</code> 函式來重置串接後的 DataFrame 索引。</p>
<p>前面說過很多 pandas 函式<strong>預設</strong>的 <code>axis</code> 參數為 <code>0</code>，代表著以<strong>列（row）</strong>為單位做特定的操作。在 <code>pd.concat</code> 的例子中則是將 2 個同樣格式的 DataFrames 依照<strong>列</strong>串接起來。</p>
<p>有時候同一筆數據的不同特徵值（features）會被存在不同檔案裡頭。以鐵達尼號的數據集舉例：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"dataset/feature_set1.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>0</td>
<td>3</td>
<td>Braund</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>1</td>
<td>1</td>
<td>Cumings</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>1</td>
<td>3</td>
<td>Heikkinen</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>1</td>
<td>1</td>
<td>Futrelle</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>Allen</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>除了乘客名稱以外，其他如年齡以及性別等特徵值則被存在另個 CSV 裡頭：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"dataset/feature_set2.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr>
<th>2</th>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>3</th>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr>
<th>4</th>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>假設這 2 個 CSV 檔案裡頭<strong>同列</strong>對應到同個乘客，則你可以很輕鬆地用 <code>pd.concat</code> 函式搭配 <code>axis=1</code> 將不同 DataFrames 依照<strong>行（column）</strong>串接：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s2">"dataset/feature_set*.csv"</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Name</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>0</td>
<td>3</td>
<td>Braund</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>1</td>
<td>1</td>
<td>Cumings</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>1</td>
<td>3</td>
<td>Heikkinen</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>1</td>
<td>1</td>
<td>Futrelle</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>Allen</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="客製化-DataFrame-顯示設定_1">客製化 DataFrame 顯示設定<a class="anchor-link" href="#客製化-DataFrame-顯示設定">&para;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>雖然 pandas 會盡可能地將一個 DataFrame 完整且漂亮地呈現出來，有時候你還是會想要改變預設的顯示方式。這節列出一些常見的使用情境。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="完整顯示所有欄位">完整顯示所有欄位<a class="anchor-link" href="#完整顯示所有欄位">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>有時候一個 DataFrame 裡頭的欄位太多， pandas 會自動省略某些中間欄位以保持頁面整潔：</p>
<div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">makeCustomDataframe</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<img src="https://leemeng.tw/images/pandas/long_dataframe.jpg" style="mix-blend-mode: initial;"/>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>但如果你無論如何都想要顯示所有欄位以方便一次查看，可以透過 <code>pd.set_option</code> 函式來改變 <code>display.max_columns</code> 設定：</p>
<div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">"display.max_columns"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<img src="https://leemeng.tw/images/pandas/long_full_dataframe.jpg" style="mix-blend-mode: initial;"/>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>注意 <code>...</code> 消失了。另外你也可以使用 <code>T</code> 來轉置（transpose）當前 DataFrame，垂直顯示所有欄位：</p>
<div class="highlight"><pre><span></span><span class="c1"># 注意轉置後 `head(15)` 代表選擇前 15 個欄位</span>
<span class="n">df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<img src="https://leemeng.tw/images/pandas/transposed_dataframe.jpg" style="mix-blend-mode: initial;"/>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>這個測試用的 DataFrame 欄位裡頭的 <code>C</code> 正代表著 column。你可以在 <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/options.html#frequently-used-options">pandas 官方文件裡查看其他常用的顯示設定</a>。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="減少顯示的欄位長度">減少顯示的欄位長度<a class="anchor-link" href="#減少顯示的欄位長度">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>這邊你一樣可以透過 <code>pd.set_option</code> 函式來限制鐵達尼號資料集裡頭 <code>Name</code> 欄位的顯示長度：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"display.max_colwidth 預設值："</span><span class="p">,</span> 
      <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">"display.max_colwidth"</span><span class="p">))</span>

<span class="c1"># 使用預設設定來顯示 DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'http://bit.ly/kaggletrain'</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"注意 Name 欄位的長度被改變了："</span><span class="p">)</span>
<span class="c1"># 客製化顯示（global）</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">"display.max_colwidth"</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>display.max_colwidth 預設值： 50
</pre>
</div>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Name</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>0</td>
<td>3</td>
<td>Braund, Mr. Owen Harris</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>1</td>
<td>1</td>
<td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>1</td>
<td>3</td>
<td>Heikkinen, Miss. Laina</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>注意 Name 欄位的長度被改變了：
</pre>
</div>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Name</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>0</td>
<td>3</td>
<td>Braund...</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>1</td>
<td>1</td>
<td>Cuming...</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>1</td>
<td>3</td>
<td>Heikki...</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O...</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="改變浮點數顯示位數">改變浮點數顯示位數<a class="anchor-link" href="#改變浮點數顯示位數">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>除了欄位長度以外，你常常會想要改變浮點數（float）顯示的小數點位數：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">"display.precision"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Name</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>0</td>
<td>3</td>
<td>Braund...</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>1</td>
<td>1</td>
<td>Cuming...</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.3</td>
<td>C85</td>
<td>C</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>1</td>
<td>3</td>
<td>Heikki...</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O...</td>
<td>7.9</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你會發現 <code>Fare</code> 欄位現在只顯示小數點<strong>後一位</strong>的數值了。另外注意剛剛設定的 <code>max_colwidth</code> 是會被套用到所有 DataFrame 的。因此這個 DataFrame 的 <code>Name</code> 欄位顯示的寬度還跟上個 DataFrame 相同：都被縮減了。</p>
<p>想要將所有調整過的設定初始化，可以執行：</p>
<div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">reset_option</span><span class="p">(</span><span class="s2">"all"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>其他常用的 options 包含：</p>
<ul>
<li><code>max_rows</code></li>
<li><code>max_columns</code></li>
<li><code>date_yearfirst</code> </li>
</ul>
<p>等等。執行 <code>pd.describe_option()</code> 可以顯示所有可供使用的 options，但如果你是在 Jupyter 筆記本內使用 pandas 的話，我推薦直接在 <code>set_option</code> 函式的括號裡輸入 <code>Shift</code> + <code>tab</code> 顯示所有選項：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<video autoplay="" loop="" muted="" playsinline="" poster="https://leemeng.tw/20190721_practical_pandas_tutorial_for_aspiring_data_scientists.ipynb" style="mix-blend-mode: initial;">
<source src="https://leemeng.tw/images/pandas/pd_set_option.mp4" type="video/mp4"/>
                    您的瀏覽器不支援影片標籤，請留言通知我：S
                </video>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="為特定-DataFrame-加點樣式">為特定 DataFrame 加點樣式<a class="anchor-link" href="#為特定-DataFrame-加點樣式">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pd.set_option</code> 函式在你想要把某些顯示設定套用到<strong>所有</strong> DataFrames 時很好用。不過很多時候你會想要讓不同 DataFrame 有不同的顯示設定或樣式（styling）。</p>
<p>比方說針對下面這個只有 10 筆數據的 DataFrame，你想要跟上一節一樣把 <code>Fare</code> 欄位弄成只有小數點後一位，但又不想影響到其他 DataFrame 或是其他欄位：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 隨機抽樣 10 筆數據來做 styling</span>
<span class="n">df_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">9527</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'Name'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_sample</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_sample</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>4</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>182</th>
<td>183</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>9.0</td>
<td>4</td>
<td>2</td>
<td>347077</td>
<td>31.3875</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>376</th>
<td>377</td>
<td>1</td>
<td>3</td>
<td>female</td>
<td>22.0</td>
<td>0</td>
<td>0</td>
<td>C 7077</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>659</th>
<td>660</td>
<td>0</td>
<td>1</td>
<td>male</td>
<td>58.0</td>
<td>0</td>
<td>2</td>
<td>35273</td>
<td>113.2750</td>
<td>D48</td>
<td>C</td>
</tr>
<tr>
<th>431</th>
<td>432</td>
<td>1</td>
<td>3</td>
<td>female</td>
<td>29.0</td>
<td>1</td>
<td>0</td>
<td>376564</td>
<td>16.1000</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>539</th>
<td>540</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>22.0</td>
<td>0</td>
<td>2</td>
<td>13568</td>
<td>49.5000</td>
<td>B39</td>
<td>C</td>
</tr>
<tr>
<th>478</th>
<td>479</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>22.0</td>
<td>0</td>
<td>0</td>
<td>350060</td>
<td>7.5208</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>791</th>
<td>792</td>
<td>0</td>
<td>2</td>
<td>male</td>
<td>16.0</td>
<td>0</td>
<td>0</td>
<td>239865</td>
<td>26.0000</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>303</th>
<td>304</td>
<td>1</td>
<td>2</td>
<td>female</td>
<td>29.0</td>
<td>0</td>
<td>0</td>
<td>226593</td>
<td>12.3500</td>
<td>E101</td>
<td>Q</td>
</tr>
<tr>
<th>70</th>
<td>71</td>
<td>0</td>
<td>2</td>
<td>male</td>
<td>32.0</td>
<td>0</td>
<td>0</td>
<td>C.A. 33111</td>
<td>10.5000</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>這時候你可以使用 <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/style.html">pandas Styler</a> 底下的 <code>format</code> 函式來做到這件事情：</p>
<div class="highlight"><pre><span></span><span class="c1"># 一個典型 chain pandas 函式的例子</span>
<span class="p">(</span><span class="n">df_sample</span><span class="o">.</span><span class="n">style</span>
     <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">'</span><span class="si">{:.1f}</span><span class="s1">'</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="s1">'Fare'</span><span class="p">)</span>
     <span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">'★五顏六色の鐵達尼號數據集☆'</span><span class="p">)</span>
     <span class="o">.</span><span class="n">hide_index</span><span class="p">()</span>
     <span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">'Age'</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
     <span class="o">.</span><span class="n">highlight_max</span><span class="p">(</span><span class="s1">'Survived'</span><span class="p">)</span>
     <span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="s1">'Greens'</span><span class="p">,</span> 
                          <span class="n">subset</span><span class="o">=</span><span class="s1">'Fare'</span><span class="p">)</span>
     <span class="o">.</span><span class="n">highlight_null</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<img src="https://leemeng.tw/images/pandas/pandas_styling.jpg"/>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>如果你從來沒有用過 <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/style.html">df.style</a>，這應該是你這輩子看過最繽紛的 DataFrame。</p>
<p>從上而下，上述程式碼對此 DataFrame 做了以下 styling：</p>
<ul>
<li>將 <code>Fare</code> 欄位的數值顯示限制到小數後第一位</li>
<li>添加一個標題輔助說明</li>
<li>隱藏索引（注意最左邊！）</li>
<li>將 <code>Age</code> 欄位依數值大小畫條狀圖</li>
<li>將 <code>Survived</code> 最大的值 highlight</li>
<li>將 <code>Fare</code> 欄位依數值畫綠色的 colormap</li>
<li>將整個 DataFrame 的空值顯示為紅色</li>
</ul>
<p><code>pd.DataFrame.style</code> 會回傳一個 Styler。你已經看到除了 <code>format</code> 函式以外，還有很多其他函式可以讓你為 DataFrame 添加樣式。使用 <code>format</code> 函式的最大好處是你不需要用像是 <code>round</code> 等函式去修改<strong>實際</strong>數值，而只是改變<strong>呈現結果</strong>而已。</p>
<p>熟悉 styling 技巧能讓你不需畫圖就能輕鬆與他人分享簡單的分析結果，也能凸顯你想讓他們關注的事物。小提醒：為了讓你能一次掌握常用函式，我把能加的樣式都加了。實務上你應該思考<a href="https://leemeng.tw/data-visualization-from-matplotlib-to-ggplot2.html">什麼視覺變數是必要的</a>，而不是盲目地添加樣式。</p>
<p>另外值得一提的是 pandas 函式都會回傳處理後的結果，而不是直接修改原始 DataFrame。這讓你可以輕鬆地把多個函式串（chain）成一個複雜的數據處理 pipeline，但又不會影響到最原始的數據：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_sample</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>4</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>182</th>
<td>183</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>9.0</td>
<td>4</td>
<td>2</td>
<td>347077</td>
<td>31.3875</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>376</th>
<td>377</td>
<td>1</td>
<td>3</td>
<td>female</td>
<td>22.0</td>
<td>0</td>
<td>0</td>
<td>C 7077</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>659</th>
<td>660</td>
<td>0</td>
<td>1</td>
<td>male</td>
<td>58.0</td>
<td>0</td>
<td>2</td>
<td>35273</td>
<td>113.2750</td>
<td>D48</td>
<td>C</td>
</tr>
<tr>
<th>431</th>
<td>432</td>
<td>1</td>
<td>3</td>
<td>female</td>
<td>29.0</td>
<td>1</td>
<td>0</td>
<td>376564</td>
<td>16.1000</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>539</th>
<td>540</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>22.0</td>
<td>0</td>
<td>2</td>
<td>13568</td>
<td>49.5000</td>
<td>B39</td>
<td>C</td>
</tr>
<tr>
<th>478</th>
<td>479</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>22.0</td>
<td>0</td>
<td>0</td>
<td>350060</td>
<td>7.5208</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>791</th>
<td>792</td>
<td>0</td>
<td>2</td>
<td>male</td>
<td>16.0</td>
<td>0</td>
<td>0</td>
<td>239865</td>
<td>26.0000</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>303</th>
<td>304</td>
<td>1</td>
<td>2</td>
<td>female</td>
<td>29.0</td>
<td>0</td>
<td>0</td>
<td>226593</td>
<td>12.3500</td>
<td>E101</td>
<td>Q</td>
</tr>
<tr>
<th>70</th>
<td>71</td>
<td>0</td>
<td>2</td>
<td>male</td>
<td>32.0</td>
<td>0</td>
<td>0</td>
<td>C.A. 33111</td>
<td>10.5000</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>瞧！原來的 DataFrame 還是挺淳樸的。注意 <code>Fare</code> 欄位裡的小數點並沒有因為剛剛的 styling 而變少，而這讓你在呈現 DataFrame 時有最大的彈性。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="數據清理-&amp;-整理_1">數據清理 &amp; 整理<a class="anchor-link" href="#數據清理-&amp;-整理">&para;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>這節列出一些十分常用的數據清理與整理技巧，如處理空值（null value）以及切割欄位。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="處理空值">處理空值<a class="anchor-link" href="#處理空值">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>世界總是殘酷，很多時候手上的 DataFrame 裡頭會有不存在的值，如底下一格格額外顯眼的 <code>NaN</code>：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">makeMissingDataframe</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>6bAs9RrtPf</th>
<td>-1.864693</td>
<td>0.395997</td>
<td>-1.057175</td>
<td>1.261987</td>
</tr>
<tr>
<th>P4pLVw54w1</th>
<td>0.817813</td>
<td>-0.893529</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>KkhqmjKghu</th>
<td>0.182929</td>
<td>0.892841</td>
<td>1.487175</td>
<td>-1.218580</td>
</tr>
<tr>
<th>S4ppq42BKt</th>
<td>1.113693</td>
<td>0.979332</td>
<td>-0.761886</td>
<td>0.026489</td>
</tr>
<tr>
<th>Mu2ryPVR0x</th>
<td>0.387857</td>
<td>0.334798</td>
<td>1.321586</td>
<td>NaN</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你可以利用 <code>fillna</code> 函式將 DataFrame 裡頭所有不存在的值設為 <code>0</code>：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>6bAs9RrtPf</th>
<td>-1.864693</td>
<td>0.395997</td>
<td>-1.057175</td>
<td>1.261987</td>
</tr>
<tr>
<th>P4pLVw54w1</th>
<td>0.817813</td>
<td>-0.893529</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr>
<th>KkhqmjKghu</th>
<td>0.182929</td>
<td>0.892841</td>
<td>1.487175</td>
<td>-1.218580</td>
</tr>
<tr>
<th>S4ppq42BKt</th>
<td>1.113693</td>
<td>0.979332</td>
<td>-0.761886</td>
<td>0.026489</td>
</tr>
<tr>
<th>Mu2ryPVR0x</th>
<td>0.387857</td>
<td>0.334798</td>
<td>1.321586</td>
<td>0.000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>當然，這個操作的前提是你確定在當前分析的情境下，將不存在的值視為 <code>0</code> 這件事情是沒有問題的。</p>
<p>針對字串欄位，你也可以將空值設定成任何容易識別的值，讓自己及他人明確了解此 DataFrame 的數據品質：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">makeMissingCustomDataframe</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> 
                                                <span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> 
                                                <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">"Unknown"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th>C0</th>
<th>C_l0_g0</th>
<th>C_l0_g1</th>
<th>C_l0_g2</th>
<th>C_l0_g3</th>
</tr>
<tr>
<th>R0</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>R_l0_g0</th>
<td>R0C0</td>
<td>R0C1</td>
<td>R0C2</td>
<td>R0C3</td>
</tr>
<tr>
<th>R_l0_g1</th>
<td>R1C0</td>
<td>R1C1</td>
<td>R1C2</td>
<td>R1C3</td>
</tr>
<tr>
<th>R_l0_g2</th>
<td>R2C0</td>
<td>R2C1</td>
<td>R2C2</td>
<td>R2C3</td>
</tr>
<tr>
<th>R_l0_g3</th>
<td>R3C0</td>
<td>Unknown</td>
<td>R3C2</td>
<td>R3C3</td>
</tr>
<tr>
<th>R_l0_g4</th>
<td>Unknown</td>
<td>R4C1</td>
<td>R4C2</td>
<td>R4C3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="捨棄不需要的行列">捨棄不需要的行列<a class="anchor-link" href="#捨棄不需要的行列">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>給定一個初始 DataFrame：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">makeDataFrame</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>87dl3rTYXR</th>
<td>0.048544</td>
<td>0.133999</td>
<td>0.885555</td>
<td>1.164883</td>
</tr>
<tr>
<th>DE0ptDHz2Q</th>
<td>0.551378</td>
<td>0.012621</td>
<td>0.256241</td>
<td>0.197140</td>
</tr>
<tr>
<th>jiWMAjniDH</th>
<td>-1.275694</td>
<td>-1.473950</td>
<td>-1.602433</td>
<td>-0.286107</td>
</tr>
<tr>
<th>45lFb2QT9g</th>
<td>1.348614</td>
<td>2.235074</td>
<td>1.471781</td>
<td>0.449909</td>
</tr>
<tr>
<th>OOOtaUhOOp</th>
<td>-0.297613</td>
<td>-1.332934</td>
<td>0.194135</td>
<td>0.654267</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你可以使用 <code>drop</code> 函式來捨棄不需要的欄位。記得將 <code>axis</code> 設為 1：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'B'</span><span class="p">,</span> <span class="s1">'D'</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<th>87dl3rTYXR</th>
<td>0.048544</td>
<td>0.885555</td>
</tr>
<tr>
<th>DE0ptDHz2Q</th>
<td>0.551378</td>
<td>0.256241</td>
</tr>
<tr>
<th>jiWMAjniDH</th>
<td>-1.275694</td>
<td>-1.602433</td>
</tr>
<tr>
<th>45lFb2QT9g</th>
<td>1.348614</td>
<td>1.471781</td>
</tr>
<tr>
<th>OOOtaUhOOp</th>
<td>-0.297613</td>
<td>0.194135</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>同理，你也可以捨棄特定列（row）：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'OOOtaUhOOp'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>87dl3rTYXR</th>
<td>0.048544</td>
<td>0.133999</td>
<td>0.885555</td>
<td>1.164883</td>
</tr>
<tr>
<th>DE0ptDHz2Q</th>
<td>0.551378</td>
<td>0.012621</td>
<td>0.256241</td>
<td>0.197140</td>
</tr>
<tr>
<th>jiWMAjniDH</th>
<td>-1.275694</td>
<td>-1.473950</td>
<td>-1.602433</td>
<td>-0.286107</td>
</tr>
<tr>
<th>45lFb2QT9g</th>
<td>1.348614</td>
<td>2.235074</td>
<td>1.471781</td>
<td>0.449909</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="重置並捨棄索引">重置並捨棄索引<a class="anchor-link" href="#重置並捨棄索引">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>很多時候你會想要重置一個 DataFrame 的索引，以方便使用 <code>loc</code> 或 <code>iloc</code> <strong>屬性</strong>來存取想要的數據。</p>
<p>給定一個 DataFrame：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">makeDataFrame</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>LI5Y0d3Ygk</th>
<td>0.704950</td>
<td>0.610508</td>
<td>-1.686467</td>
<td>0.165393</td>
</tr>
<tr>
<th>9EkrfcGaKh</th>
<td>1.088294</td>
<td>-0.947646</td>
<td>1.382226</td>
<td>-1.410468</td>
</tr>
<tr>
<th>Jf891pQjSh</th>
<td>0.137240</td>
<td>1.490714</td>
<td>1.236335</td>
<td>-0.270623</td>
</tr>
<tr>
<th>Q9O2vu4Mg1</th>
<td>-0.375816</td>
<td>2.308924</td>
<td>-1.735557</td>
<td>1.734371</td>
</tr>
<tr>
<th>z0xoUxOAWW</th>
<td>1.067996</td>
<td>0.474090</td>
<td>-0.492757</td>
<td>-0.042121</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你可以使用 <code>reset_index</code> 函式來重置此 DataFrame 的索引並輕鬆存取想要的部分：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span>
<span class="c1"># 豆知識：因為 iloc 是屬性而非函式，</span>
<span class="c1"># 因此你得使用 [] 而非 () 存取數據</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>index</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>LI5Y0d3Ygk</td>
<td>0.704950</td>
<td>0.610508</td>
<td>-1.686467</td>
<td>0.165393</td>
</tr>
<tr>
<th>1</th>
<td>9EkrfcGaKh</td>
<td>1.088294</td>
<td>-0.947646</td>
<td>1.382226</td>
<td>-1.410468</td>
</tr>
<tr>
<th>2</th>
<td>Jf891pQjSh</td>
<td>0.137240</td>
<td>1.490714</td>
<td>1.236335</td>
<td>-0.270623</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>將函式的 <code>inplace</code> 參數設為 <code>True</code> 會讓 pandas 直接修改 <code>df</code>。一般來說 pandas 裡的函式並不會修改原始 DataFrame，這樣可以保證原始數據不會受到任何函式的影響。</p>
<p>當你不想要原來的 DataFrame <code>df</code> 受到 <code>reset_index</code> 函式的影響，則可以將處理後的結果交給一個新 DataFrame（比方說 <code>df1</code>）：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">makeDataFrame</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>fNMRqfPnw1</th>
<td>0.458255</td>
<td>1.736118</td>
<td>-1.659602</td>
<td>2.325742</td>
</tr>
<tr>
<th>xeIJ4tJuxW</th>
<td>-1.102030</td>
<td>1.321306</td>
<td>-0.262345</td>
<td>0.864090</td>
</tr>
<tr>
<th>RDAJlNsfDS</th>
<td>1.047750</td>
<td>-0.420285</td>
<td>0.757464</td>
<td>0.384514</td>
</tr>
<tr>
<th>kIOVU4EU79</th>
<td>-0.843373</td>
<td>0.235789</td>
<td>-1.211142</td>
<td>0.656130</td>
</tr>
<tr>
<th>OKuRXq4eEK</th>
<td>-1.340040</td>
<td>0.674713</td>
<td>0.768126</td>
<td>-0.500718</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0.458255</td>
<td>1.736118</td>
<td>-1.659602</td>
<td>2.325742</td>
</tr>
<tr>
<th>1</th>
<td>-1.102030</td>
<td>1.321306</td>
<td>-0.262345</td>
<td>0.864090</td>
</tr>
<tr>
<th>2</th>
<td>1.047750</td>
<td>-0.420285</td>
<td>0.757464</td>
<td>0.384514</td>
</tr>
<tr>
<th>3</th>
<td>-0.843373</td>
<td>0.235789</td>
<td>-1.211142</td>
<td>0.656130</td>
</tr>
<tr>
<th>4</th>
<td>-1.340040</td>
<td>0.674713</td>
<td>0.768126</td>
<td>-0.500718</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>透過這樣的方式，pandas 讓你可以放心地對原始數據做任何壞壞的事情而不會產生任何不好的影響。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="將字串切割成多個欄位">將字串切割成多個欄位<a class="anchor-link" href="#將字串切割成多個欄位">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在處理文本數據時，很多時候你會想要把一個字串欄位拆成多個欄位以方便後續處理。</p>
<p>給定一個簡單 DataFrame：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">"name"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"大雄"</span><span class="p">,</span> <span class="s2">"胖虎"</span><span class="p">],</span> 
    <span class="s2">"feature"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"膽小, 翻花繩"</span><span class="p">,</span> <span class="s2">"粗魯, 演唱會"</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>name</th>
<th>feature</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>大雄</td>
<td>膽小, 翻花繩</td>
</tr>
<tr>
<th>1</th>
<td>胖虎</td>
<td>粗魯, 演唱會</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你可能會想把這個 DataFrame 的 <code>feature</code> 欄位分成不同欄位，這時候利用 <code>str</code> 將字串取出，並透過 <code>expand=True</code> 將字串切割的結果擴大成（expand）成一個 DataFrame：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">'性格'</span><span class="p">,</span> <span class="s1">'特技'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>name</th>
<th>feature</th>
<th>性格</th>
<th>特技</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>大雄</td>
<td>膽小, 翻花繩</td>
<td>膽小</td>
<td>翻花繩</td>
</tr>
<tr>
<th>1</th>
<td>胖虎</td>
<td>粗魯, 演唱會</td>
<td>粗魯</td>
<td>演唱會</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>注意我們使用 <code>df[columns] = ...</code> 的形式將字串切割出來的 2 個新欄位分別指定成 <code>性格</code> 與 <code>特技</code>。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="將-list-分成多個欄位">將 list 分成多個欄位<a class="anchor-link" href="#將-list-分成多個欄位">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>有時候一個欄位裡頭的值為 Python <code>list</code>：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">"name"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"大雄"</span><span class="p">,</span> <span class="s2">"胖虎"</span><span class="p">],</span> 
    <span class="s2">"feature"</span><span class="p">:</span> <span class="p">[[</span><span class="s2">"膽小"</span><span class="p">,</span> <span class="s2">"翻花繩"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"粗魯"</span><span class="p">,</span> <span class="s2">"演唱會"</span><span class="p">]]</span>
<span class="p">})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>name</th>
<th>feature</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>大雄</td>
<td>[膽小, 翻花繩]</td>
</tr>
<tr>
<th>1</th>
<td>胖虎</td>
<td>[粗魯, 演唱會]</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>這時則可以使用 <code>tolist</code> 函式做到跟剛剛字串切割相同的效果：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'性格'</span><span class="p">,</span> <span class="s1">'特技'</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>性格</th>
<th>特技</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>膽小</td>
<td>翻花繩</td>
</tr>
<tr>
<th>1</th>
<td>粗魯</td>
<td>演唱會</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你也可以使用 <code>apply(pd.Series)</code> 的方式達到一樣的效果：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>0</th>
<th>1</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>膽小</td>
<td>翻花繩</td>
</tr>
<tr>
<th>1</th>
<td>粗魯</td>
<td>演唱會</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>遇到以 Python <code>list</code> 呈現欄位數據的情境不少，這些函式能讓你少抓點頭。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="取得想要關注的數據_1">取得想要關注的數據<a class="anchor-link" href="#取得想要關注的數據">&para;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>通常你會需要依照各種不同的分析情境，將整個 DataFrame 裡頭的一部份數據取出並進一步分析。這節內容讓你能夠輕鬆取得想要關注的數據。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="基本數據切割">基本數據切割<a class="anchor-link" href="#基本數據切割">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在 pandas 裡頭，切割（Slice）DataFrame 裡頭一部份數據出來做分析是稀鬆平常的事情。讓我們再次以鐵達尼號數據集為例：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'http://bit.ly/kaggletrain'</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"Name"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>1</td>
<td>3</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你可以透過 <code>loc</code> 以及 <code>:</code> 的方式輕鬆選取從某個起始欄位 C1 到結束欄位 C2 的所有欄位，而無需將中間的欄位一一列出：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">'Pclass'</span><span class="p">:</span><span class="s1">'Ticket'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>3</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
</tr>
<tr>
<th>3</th>
<td>1</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="反向選取行列">反向選取行列<a class="anchor-link" href="#反向選取行列">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>透過 Python 常見的 <code>[::-1]</code> 語法，你可以輕易地改變 DataFrame 裡頭所有欄位的排列順序：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Embarked</th>
<th>Cabin</th>
<th>Fare</th>
<th>Ticket</th>
<th>Parch</th>
<th>SibSp</th>
<th>Age</th>
<th>Sex</th>
<th>Pclass</th>
<th>Survived</th>
<th>PassengerId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>S</td>
<td>NaN</td>
<td>7.2500</td>
<td>A/5 21171</td>
<td>0</td>
<td>1</td>
<td>22.0</td>
<td>male</td>
<td>3</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>1</th>
<td>C</td>
<td>C85</td>
<td>71.2833</td>
<td>PC 17599</td>
<td>0</td>
<td>1</td>
<td>38.0</td>
<td>female</td>
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<th>2</th>
<td>S</td>
<td>NaN</td>
<td>7.9250</td>
<td>STON/O2. 3101282</td>
<td>0</td>
<td>0</td>
<td>26.0</td>
<td>female</td>
<td>3</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<th>3</th>
<td>S</td>
<td>C123</td>
<td>53.1000</td>
<td>113803</td>
<td>0</td>
<td>1</td>
<td>35.0</td>
<td>female</td>
<td>1</td>
<td>1</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>同樣概念也可以運用到列（row）上面。你可以將所有樣本（samples）排序顛倒並選取其中 N 列：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
</tr>
</thead>
<tbody>
<tr>
<th>890</th>
<td>891</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>32.0</td>
</tr>
<tr>
<th>889</th>
<td>890</td>
<td>1</td>
<td>1</td>
<td>male</td>
<td>26.0</td>
</tr>
<tr>
<th>888</th>
<td>889</td>
<td>0</td>
<td>3</td>
<td>female</td>
<td>NaN</td>
</tr>
<tr>
<th>887</th>
<td>888</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>19.0</td>
</tr>
<tr>
<th>886</th>
<td>887</td>
<td>0</td>
<td>2</td>
<td>male</td>
<td>27.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>注意我們同時使用 <code>:5</code> 來選出前 5 個欄位。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="條件選取數據">條件選取數據<a class="anchor-link" href="#條件選取數據">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在 pandas 裡頭最實用的選取技巧大概非遮罩（masking）莫屬了。遮罩讓 pandas 將符合特定條件的樣本回傳：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">male_and_age_over_70</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Sex</span> <span class="o">==</span> <span class="s1">'male'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Age</span> <span class="o">&gt;</span> <span class="mi">70</span><span class="p">)</span>
<span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">male_and_age_over_70</span><span class="p">]</span>
    <span class="o">.</span><span class="n">style</span>
    <span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">'background-color: rgb(153, 255, 51)'</span><span class="p">,</span> 
              <span class="n">subset</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="s1">'Sex'</span><span class="p">:</span><span class="s1">'Age'</span><span class="p">]))</span>
<span class="c1"># 跟 df[(df.Sex == 'male') &amp; (df.Age &gt; 70)] 結果相同</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<style type="text/css">
    #T_68f75918_b060_11e9_8b6c_8c8590794fe2row0_col3 {
            background-color:  rgb(153, 255, 51);
        }    #T_68f75918_b060_11e9_8b6c_8c8590794fe2row0_col4 {
            background-color:  rgb(153, 255, 51);
        }    #T_68f75918_b060_11e9_8b6c_8c8590794fe2row1_col3 {
            background-color:  rgb(153, 255, 51);
        }    #T_68f75918_b060_11e9_8b6c_8c8590794fe2row1_col4 {
            background-color:  rgb(153, 255, 51);
        }    #T_68f75918_b060_11e9_8b6c_8c8590794fe2row2_col3 {
            background-color:  rgb(153, 255, 51);
        }    #T_68f75918_b060_11e9_8b6c_8c8590794fe2row2_col4 {
            background-color:  rgb(153, 255, 51);
        }    #T_68f75918_b060_11e9_8b6c_8c8590794fe2row3_col3 {
            background-color:  rgb(153, 255, 51);
        }    #T_68f75918_b060_11e9_8b6c_8c8590794fe2row3_col4 {
            background-color:  rgb(153, 255, 51);
        }    #T_68f75918_b060_11e9_8b6c_8c8590794fe2row4_col3 {
            background-color:  rgb(153, 255, 51);
        }    #T_68f75918_b060_11e9_8b6c_8c8590794fe2row4_col4 {
            background-color:  rgb(153, 255, 51);
        }</style><table class="table table-striped table-responsive" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2"><thead> <tr> <th class="blank level0"></th> <th class="col_heading level0 col0">PassengerId</th> <th class="col_heading level0 col1">Survived</th> <th class="col_heading level0 col2">Pclass</th> <th class="col_heading level0 col3">Sex</th> <th class="col_heading level0 col4">Age</th> <th class="col_heading level0 col5">SibSp</th> <th class="col_heading level0 col6">Parch</th> <th class="col_heading level0 col7">Ticket</th> <th class="col_heading level0 col8">Fare</th> <th class="col_heading level0 col9">Cabin</th> <th class="col_heading level0 col10">Embarked</th> </tr></thead><tbody>
<tr>
<th class="row_heading level0 row0" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2level0_row0">96</th>
<td class="data row0 col0" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row0_col0">97</td>
<td class="data row0 col1" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row0_col1">0</td>
<td class="data row0 col2" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row0_col2">1</td>
<td class="data row0 col3" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row0_col3">male</td>
<td class="data row0 col4" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row0_col4">71</td>
<td class="data row0 col5" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row0_col5">0</td>
<td class="data row0 col6" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row0_col6">0</td>
<td class="data row0 col7" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row0_col7">PC 17754</td>
<td class="data row0 col8" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row0_col8">34.6542</td>
<td class="data row0 col9" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row0_col9">A5</td>
<td class="data row0 col10" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row0_col10">C</td>
</tr>
<tr>
<th class="row_heading level0 row1" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2level0_row1">116</th>
<td class="data row1 col0" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row1_col0">117</td>
<td class="data row1 col1" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row1_col1">0</td>
<td class="data row1 col2" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row1_col2">3</td>
<td class="data row1 col3" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row1_col3">male</td>
<td class="data row1 col4" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row1_col4">70.5</td>
<td class="data row1 col5" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row1_col5">0</td>
<td class="data row1 col6" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row1_col6">0</td>
<td class="data row1 col7" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row1_col7">370369</td>
<td class="data row1 col8" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row1_col8">7.75</td>
<td class="data row1 col9" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row1_col9">nan</td>
<td class="data row1 col10" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row1_col10">Q</td>
</tr>
<tr>
<th class="row_heading level0 row2" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2level0_row2">493</th>
<td class="data row2 col0" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row2_col0">494</td>
<td class="data row2 col1" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row2_col1">0</td>
<td class="data row2 col2" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row2_col2">1</td>
<td class="data row2 col3" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row2_col3">male</td>
<td class="data row2 col4" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row2_col4">71</td>
<td class="data row2 col5" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row2_col5">0</td>
<td class="data row2 col6" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row2_col6">0</td>
<td class="data row2 col7" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row2_col7">PC 17609</td>
<td class="data row2 col8" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row2_col8">49.5042</td>
<td class="data row2 col9" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row2_col9">nan</td>
<td class="data row2 col10" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row2_col10">C</td>
</tr>
<tr>
<th class="row_heading level0 row3" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2level0_row3">630</th>
<td class="data row3 col0" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row3_col0">631</td>
<td class="data row3 col1" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row3_col1">1</td>
<td class="data row3 col2" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row3_col2">1</td>
<td class="data row3 col3" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row3_col3">male</td>
<td class="data row3 col4" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row3_col4">80</td>
<td class="data row3 col5" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row3_col5">0</td>
<td class="data row3 col6" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row3_col6">0</td>
<td class="data row3 col7" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row3_col7">27042</td>
<td class="data row3 col8" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row3_col8">30</td>
<td class="data row3 col9" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row3_col9">A23</td>
<td class="data row3 col10" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row3_col10">S</td>
</tr>
<tr>
<th class="row_heading level0 row4" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2level0_row4">851</th>
<td class="data row4 col0" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row4_col0">852</td>
<td class="data row4 col1" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row4_col1">0</td>
<td class="data row4 col2" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row4_col2">3</td>
<td class="data row4 col3" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row4_col3">male</td>
<td class="data row4 col4" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row4_col4">74</td>
<td class="data row4 col5" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row4_col5">0</td>
<td class="data row4 col6" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row4_col6">0</td>
<td class="data row4 col7" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row4_col7">347060</td>
<td class="data row4 col8" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row4_col8">7.775</td>
<td class="data row4 col9" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row4_col9">nan</td>
<td class="data row4 col10" id="T_68f75918_b060_11e9_8b6c_8c8590794fe2row4_col10">S</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>male_and_age_over_70</code> 是我們定義的一個遮罩，可以把同時符合兩個布林判斷式（大於 70 歲、男性）的樣本選取出來。上面註解有相同效果，但當存在多個判斷式時，有個準確說明遮罩意義的變數（上例的 <code>male_and_age_over_70</code>）會讓你的程式碼好懂一點。</p>
<p>另外你也可以使用 <code>query</code> 函式來達到跟遮罩一樣的效果：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">age</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"Age &gt; @age &amp; Sex == 'male'"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>96</th>
<td>97</td>
<td>0</td>
<td>1</td>
<td>male</td>
<td>71.0</td>
<td>0</td>
<td>0</td>
<td>PC 17754</td>
<td>34.6542</td>
<td>A5</td>
<td>C</td>
</tr>
<tr>
<th>116</th>
<td>117</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>70.5</td>
<td>0</td>
<td>0</td>
<td>370369</td>
<td>7.7500</td>
<td>NaN</td>
<td>Q</td>
</tr>
<tr>
<th>493</th>
<td>494</td>
<td>0</td>
<td>1</td>
<td>male</td>
<td>71.0</td>
<td>0</td>
<td>0</td>
<td>PC 17609</td>
<td>49.5042</td>
<td>NaN</td>
<td>C</td>
</tr>
<tr>
<th>630</th>
<td>631</td>
<td>1</td>
<td>1</td>
<td>male</td>
<td>80.0</td>
<td>0</td>
<td>0</td>
<td>27042</td>
<td>30.0000</td>
<td>A23</td>
<td>S</td>
</tr>
<tr>
<th>851</th>
<td>852</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>74.0</td>
<td>0</td>
<td>0</td>
<td>347060</td>
<td>7.7750</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在這個例子裡頭，你可以使用 <code>@</code> 來存取已經定義的 Python 變數 <code>age</code> 的值。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="選擇任一欄有空值的樣本">選擇任一欄有空值的樣本<a class="anchor-link" href="#選擇任一欄有空值的樣本">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>一個 DataFrame 裡常會有多個欄位（column），而每個欄位裡頭都有可能包含空值。</p>
<p>有時候你會想把在<strong>任一</strong>欄位（column）出現過空值的樣本（row）全部取出：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> \
    <span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">highlight_null</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<style type="text/css">
    #T_31d6affa_b061_11e9_8b6c_8c8590794fe2row0_col9 {
            background-color:  red;
        }    #T_31d6affa_b061_11e9_8b6c_8c8590794fe2row1_col9 {
            background-color:  red;
        }    #T_31d6affa_b061_11e9_8b6c_8c8590794fe2row2_col9 {
            background-color:  red;
        }    #T_31d6affa_b061_11e9_8b6c_8c8590794fe2row3_col4 {
            background-color:  red;
        }    #T_31d6affa_b061_11e9_8b6c_8c8590794fe2row3_col9 {
            background-color:  red;
        }    #T_31d6affa_b061_11e9_8b6c_8c8590794fe2row4_col9 {
            background-color:  red;
        }</style><table class="table table-striped table-responsive" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2"><thead> <tr> <th class="blank level0"></th> <th class="col_heading level0 col0">PassengerId</th> <th class="col_heading level0 col1">Survived</th> <th class="col_heading level0 col2">Pclass</th> <th class="col_heading level0 col3">Sex</th> <th class="col_heading level0 col4">Age</th> <th class="col_heading level0 col5">SibSp</th> <th class="col_heading level0 col6">Parch</th> <th class="col_heading level0 col7">Ticket</th> <th class="col_heading level0 col8">Fare</th> <th class="col_heading level0 col9">Cabin</th> <th class="col_heading level0 col10">Embarked</th> </tr></thead><tbody>
<tr>
<th class="row_heading level0 row0" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2level0_row0">0</th>
<td class="data row0 col0" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row0_col0">1</td>
<td class="data row0 col1" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row0_col1">0</td>
<td class="data row0 col2" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row0_col2">3</td>
<td class="data row0 col3" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row0_col3">male</td>
<td class="data row0 col4" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row0_col4">22</td>
<td class="data row0 col5" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row0_col5">1</td>
<td class="data row0 col6" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row0_col6">0</td>
<td class="data row0 col7" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row0_col7">A/5 21171</td>
<td class="data row0 col8" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row0_col8">7.25</td>
<td class="data row0 col9" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row0_col9">nan</td>
<td class="data row0 col10" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row0_col10">S</td>
</tr>
<tr>
<th class="row_heading level0 row1" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2level0_row1">2</th>
<td class="data row1 col0" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row1_col0">3</td>
<td class="data row1 col1" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row1_col1">1</td>
<td class="data row1 col2" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row1_col2">3</td>
<td class="data row1 col3" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row1_col3">female</td>
<td class="data row1 col4" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row1_col4">26</td>
<td class="data row1 col5" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row1_col5">0</td>
<td class="data row1 col6" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row1_col6">0</td>
<td class="data row1 col7" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row1_col7">STON/O2. 3101282</td>
<td class="data row1 col8" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row1_col8">7.925</td>
<td class="data row1 col9" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row1_col9">nan</td>
<td class="data row1 col10" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row1_col10">S</td>
</tr>
<tr>
<th class="row_heading level0 row2" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2level0_row2">4</th>
<td class="data row2 col0" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row2_col0">5</td>
<td class="data row2 col1" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row2_col1">0</td>
<td class="data row2 col2" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row2_col2">3</td>
<td class="data row2 col3" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row2_col3">male</td>
<td class="data row2 col4" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row2_col4">35</td>
<td class="data row2 col5" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row2_col5">0</td>
<td class="data row2 col6" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row2_col6">0</td>
<td class="data row2 col7" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row2_col7">373450</td>
<td class="data row2 col8" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row2_col8">8.05</td>
<td class="data row2 col9" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row2_col9">nan</td>
<td class="data row2 col10" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row2_col10">S</td>
</tr>
<tr>
<th class="row_heading level0 row3" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2level0_row3">5</th>
<td class="data row3 col0" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row3_col0">6</td>
<td class="data row3 col1" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row3_col1">0</td>
<td class="data row3 col2" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row3_col2">3</td>
<td class="data row3 col3" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row3_col3">male</td>
<td class="data row3 col4" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row3_col4">nan</td>
<td class="data row3 col5" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row3_col5">0</td>
<td class="data row3 col6" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row3_col6">0</td>
<td class="data row3 col7" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row3_col7">330877</td>
<td class="data row3 col8" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row3_col8">8.4583</td>
<td class="data row3 col9" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row3_col9">nan</td>
<td class="data row3 col10" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row3_col10">Q</td>
</tr>
<tr>
<th class="row_heading level0 row4" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2level0_row4">7</th>
<td class="data row4 col0" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row4_col0">8</td>
<td class="data row4 col1" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row4_col1">0</td>
<td class="data row4 col2" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row4_col2">3</td>
<td class="data row4 col3" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row4_col3">male</td>
<td class="data row4 col4" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row4_col4">2</td>
<td class="data row4 col5" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row4_col5">3</td>
<td class="data row4 col6" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row4_col6">1</td>
<td class="data row4 col7" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row4_col7">349909</td>
<td class="data row4 col8" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row4_col8">21.075</td>
<td class="data row4 col9" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row4_col9">nan</td>
<td class="data row4 col10" id="T_31d6affa_b061_11e9_8b6c_8c8590794fe2row4_col10">S</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>這邊剛好所有樣本的 <code>Cabin</code> 欄位皆為空值。但倒數第 2 個樣本就算其 <code>Cabin</code> 欄不為空值，也會因為 <code>Age</code> 欄為空而被選出。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="選取或排除特定類型欄位">選取或排除特定類型欄位<a class="anchor-link" href="#選取或排除特定類型欄位">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>有時候你會想選取 DataFrame 裡特定數據類型（字串、數值、時間型態等）的欄位，這時你可以使用 <code>select_dtypes</code> 函式：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">'number'</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Fare</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>0</td>
<td>3</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>7.2500</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>1</td>
<td>1</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>71.2833</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>1</td>
<td>3</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>7.9250</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>1</td>
<td>1</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>53.1000</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>8.0500</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>上面我們用一行程式碼就把所有數值欄位取出，儘管我們根本不知道有什麼欄位。而你當然也可以利用 <code>exclude</code> 參數來排除特定類型的欄位：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 建立一個有多種數據形態的 DataFrame</span>
<span class="n">df_mix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">makeMixedDataFrame</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_mix</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_mix</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_mix</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">'datetime64'</span><span class="p">,</span> <span class="s1">'object'</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0.0</td>
<td>0.0</td>
<td>foo1</td>
<td>2009-01-01</td>
</tr>
<tr>
<th>1</th>
<td>1.0</td>
<td>1.0</td>
<td>foo2</td>
<td>2009-01-02</td>
</tr>
<tr>
<th>2</th>
<td>2.0</td>
<td>0.0</td>
<td>foo3</td>
<td>2009-01-05</td>
</tr>
<tr>
<th>3</th>
<td>3.0</td>
<td>1.0</td>
<td>foo4</td>
<td>2009-01-06</td>
</tr>
<tr>
<th>4</th>
<td>4.0</td>
<td>0.0</td>
<td>foo5</td>
<td>2009-01-07</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="output_area">
<div class="output_text output_subarea">
<pre>A           float64
B           float64
C            object
D    datetime64[ns]
dtype: object</pre>
</div>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr>
<th>2</th>
<td>2.0</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr>
<th>4</th>
<td>4.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>pandas 裡的函式使用上都很直覺，你可以丟入 1 個包含多個元素的 Python <code>list</code> 或是單一 <code>str</code> 作為參數輸入。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="選取所有出現在-list-內的樣本">選取所有出現在 list 內的樣本<a class="anchor-link" href="#選取所有出現在-list-內的樣本">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>很多時候針對某一個特定欄位，你會想要取出所有出現在一個 <code>list</code> 的樣本。這時候你可以使用 <code>isin</code> 函式來做到這件事情：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tickets</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"SC/Paris 2123"</span><span class="p">,</span> <span class="s2">"PC 17475"</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Ticket</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">tickets</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>43</th>
<td>44</td>
<td>1</td>
<td>2</td>
<td>female</td>
<td>3.0</td>
<td>1</td>
<td>2</td>
<td>SC/Paris 2123</td>
<td>41.5792</td>
<td>NaN</td>
<td>C</td>
</tr>
<tr>
<th>608</th>
<td>609</td>
<td>1</td>
<td>2</td>
<td>female</td>
<td>22.0</td>
<td>1</td>
<td>2</td>
<td>SC/Paris 2123</td>
<td>41.5792</td>
<td>NaN</td>
<td>C</td>
</tr>
<tr>
<th>685</th>
<td>686</td>
<td>0</td>
<td>2</td>
<td>male</td>
<td>25.0</td>
<td>1</td>
<td>2</td>
<td>SC/Paris 2123</td>
<td>41.5792</td>
<td>NaN</td>
<td>C</td>
</tr>
<tr>
<th>701</th>
<td>702</td>
<td>1</td>
<td>1</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>PC 17475</td>
<td>26.2875</td>
<td>E24</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="選取某欄位為-top-k-值的樣本">選取某欄位為 top-k 值的樣本<a class="anchor-link" href="#選取某欄位為-top-k-值的樣本">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>很多時候你會想選取在某個欄位中前 k 大的所有樣本。這時你可以先利用 <code>value_counts</code> 函式找出該欄位前 k 多的值：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">top_k</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">top_tickets</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Ticket</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[:</span><span class="n">top_k</span><span class="p">]</span>
<span class="n">top_tickets</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>Index(['347082', '1601', 'CA. 2343'], dtype='object')</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>這邊我們以欄位 <code>Ticket</code> 為例。另外你也可以使用 <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html">pandas.Series</a> 裡的 <code>nlargest</code> 函式取得相同結果：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">Ticket</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">top_k</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>Index(['347082', '1601', 'CA. 2343'], dtype='object')</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>接著利用上小節看過的 <code>isin</code> 函式就能輕鬆取得 <code>Ticket</code>欄位值為前 k 大值的樣本：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Ticket</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">top_tickets</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>13</th>
<td>14</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>39.0</td>
<td>1</td>
<td>5</td>
<td>347082</td>
<td>31.2750</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>74</th>
<td>75</td>
<td>1</td>
<td>3</td>
<td>male</td>
<td>32.0</td>
<td>0</td>
<td>0</td>
<td>1601</td>
<td>56.4958</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>119</th>
<td>120</td>
<td>0</td>
<td>3</td>
<td>female</td>
<td>2.0</td>
<td>4</td>
<td>2</td>
<td>347082</td>
<td>31.2750</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>159</th>
<td>160</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>NaN</td>
<td>8</td>
<td>2</td>
<td>CA. 2343</td>
<td>69.5500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>169</th>
<td>170</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>28.0</td>
<td>0</td>
<td>0</td>
<td>1601</td>
<td>56.4958</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="找出符合特定字串的樣本">找出符合特定字串的樣本<a class="anchor-link" href="#找出符合特定字串的樣本">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>有時你會想要對一個字串欄位做正規表示式（regular expression），取出符合某個 pattern 的所有樣本。</p>
<p>這時你可以使用 <code>str</code> 底下的 <code>contains</code> 函式：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'http://bit.ly/kaggletrain'</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Mr\."</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Name</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>0</td>
<td>3</td>
<td>Braund, Mr. Owen Harris</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>Allen, Mr. William Henry</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>5</th>
<td>6</td>
<td>0</td>
<td>3</td>
<td>Moran, Mr. James</td>
<td>male</td>
<td>NaN</td>
<td>0</td>
<td>0</td>
<td>330877</td>
<td>8.4583</td>
<td>NaN</td>
<td>Q</td>
</tr>
<tr>
<th>6</th>
<td>7</td>
<td>0</td>
<td>1</td>
<td>McCarthy, Mr. Timothy J</td>
<td>male</td>
<td>54.0</td>
<td>0</td>
<td>0</td>
<td>17463</td>
<td>51.8625</td>
<td>E46</td>
<td>S</td>
</tr>
<tr>
<th>12</th>
<td>13</td>
<td>0</td>
<td>3</td>
<td>Saundercock, Mr. William Henry</td>
<td>male</td>
<td>20.0</td>
<td>0</td>
<td>0</td>
<td>A/5. 2151</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>這邊我們將所有 <code>Name</code> 欄位值裡包含 <code>Mr.</code> 的樣本取出。注意 <code>contains</code> 函式接受的是正規表示式，因此需要將 <code>.</code> 轉換成 <code>\.</code>。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="使用正規表示式選取數據">使用正規表示式選取數據<a class="anchor-link" href="#使用正規表示式選取數據">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>有時候你會想要依照一些規則來選取 DataFrame 裡頭的值、索引或是欄位，尤其是在處理跟時間序列相關的數據：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">makeTimeDataFrame</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">'7D'</span><span class="p">)</span>
<span class="n">df_date</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>2000-01-01</th>
<td>-0.143945</td>
<td>-0.020783</td>
<td>1.434651</td>
<td>1.044208</td>
</tr>
<tr>
<th>2000-01-08</th>
<td>-0.901508</td>
<td>-1.082932</td>
<td>-1.035743</td>
<td>0.334431</td>
</tr>
<tr>
<th>2000-01-15</th>
<td>-1.544868</td>
<td>1.183136</td>
<td>-0.913117</td>
<td>-1.199199</td>
</tr>
<tr>
<th>2000-01-22</th>
<td>0.604091</td>
<td>-0.233628</td>
<td>-0.348109</td>
<td>1.082138</td>
</tr>
<tr>
<th>2000-01-29</th>
<td>0.062112</td>
<td>1.565870</td>
<td>-0.791369</td>
<td>1.017766</td>
</tr>
<tr>
<th>2000-02-05</th>
<td>-0.013661</td>
<td>1.015528</td>
<td>-0.420123</td>
<td>-0.513559</td>
</tr>
<tr>
<th>2000-02-12</th>
<td>0.404094</td>
<td>0.486909</td>
<td>-0.815937</td>
<td>0.743381</td>
</tr>
<tr>
<th>2000-02-19</th>
<td>-0.288886</td>
<td>2.560776</td>
<td>-0.864528</td>
<td>0.727740</td>
</tr>
<tr>
<th>2000-02-26</th>
<td>0.975203</td>
<td>-0.551452</td>
<td>0.531635</td>
<td>-0.595716</td>
</tr>
<tr>
<th>2000-03-04</th>
<td>-0.045714</td>
<td>0.137413</td>
<td>2.187056</td>
<td>1.164371</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>假設你想將所有索引在 2000 年 2 月內的樣本取出，則可以透過 <code>filter</code> 函式達成這個目的：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_date</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s2">"2000-02.*"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>2000-02-05</th>
<td>-0.013661</td>
<td>1.015528</td>
<td>-0.420123</td>
<td>-0.513559</td>
</tr>
<tr>
<th>2000-02-12</th>
<td>0.404094</td>
<td>0.486909</td>
<td>-0.815937</td>
<td>0.743381</td>
</tr>
<tr>
<th>2000-02-19</th>
<td>-0.288886</td>
<td>2.560776</td>
<td>-0.864528</td>
<td>0.727740</td>
</tr>
<tr>
<th>2000-02-26</th>
<td>0.975203</td>
<td>-0.551452</td>
<td>0.531635</td>
<td>-0.595716</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>filter</code> 函式本身功能十分強大，有興趣的讀者可以<a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.filter.html">閱讀官方文件進一步了解其用法</a>。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="選取從某時間點開始的區間樣本">選取從某時間點開始的區間樣本<a class="anchor-link" href="#選取從某時間點開始的區間樣本">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在處理時間數據時，很多時候你會想要針對某個起始時間挑出前 t 個時間點的樣本。</p>
<p>讓我們再看一次剛剛建立的 DataFrame：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_date</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>2000-01-01</th>
<td>-0.143945</td>
<td>-0.020783</td>
<td>1.434651</td>
<td>1.044208</td>
</tr>
<tr>
<th>2000-01-08</th>
<td>-0.901508</td>
<td>-1.082932</td>
<td>-1.035743</td>
<td>0.334431</td>
</tr>
<tr>
<th>2000-01-15</th>
<td>-1.544868</td>
<td>1.183136</td>
<td>-0.913117</td>
<td>-1.199199</td>
</tr>
<tr>
<th>2000-01-22</th>
<td>0.604091</td>
<td>-0.233628</td>
<td>-0.348109</td>
<td>1.082138</td>
</tr>
<tr>
<th>2000-01-29</th>
<td>0.062112</td>
<td>1.565870</td>
<td>-0.791369</td>
<td>1.017766</td>
</tr>
<tr>
<th>2000-02-05</th>
<td>-0.013661</td>
<td>1.015528</td>
<td>-0.420123</td>
<td>-0.513559</td>
</tr>
<tr>
<th>2000-02-12</th>
<td>0.404094</td>
<td>0.486909</td>
<td>-0.815937</td>
<td>0.743381</td>
</tr>
<tr>
<th>2000-02-19</th>
<td>-0.288886</td>
<td>2.560776</td>
<td>-0.864528</td>
<td>0.727740</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在索引為時間型態的情況下，如果你想要把前 3 週的樣本取出，可以使用 <code>first</code> 函式：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_date</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="s1">'3W'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>2000-01-01</th>
<td>-0.143945</td>
<td>-0.020783</td>
<td>1.434651</td>
<td>1.044208</td>
</tr>
<tr>
<th>2000-01-08</th>
<td>-0.901508</td>
<td>-1.082932</td>
<td>-1.035743</td>
<td>0.334431</td>
</tr>
<tr>
<th>2000-01-15</th>
<td>-1.544868</td>
<td>1.183136</td>
<td>-0.913117</td>
<td>-1.199199</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>十分方便的函式。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="基本數據處理與轉換_1">基本數據處理與轉換<a class="anchor-link" href="#基本數據處理與轉換">&para;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在了解如何選取想要的數據以後，你可以透過這節的介紹來熟悉 pandas 裡一些常見的數據處理方式。這章節也是我認為使用 pandas 處理數據時最令人愉快的部分之一。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="對某一軸套用相同運算">對某一軸套用相同運算<a class="anchor-link" href="#對某一軸套用相同運算">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你時常會需要對 DataFrame 裡頭的每一個欄位（縱軸）或是每一列（橫軸）做相同的運算。</p>
<p>比方說你想將鐵達尼號資料集內的 <code>Survived</code> 數值欄位轉換成人類容易理解的字串：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 重新讀取鐵達尼號數據</span>
<span class="n">df_titanic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'http://bit.ly/kaggletrain'</span><span class="p">)</span>
<span class="n">df_titanic</span> <span class="o">=</span> <span class="n">df_titanic</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"Name"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 複製一份副本 DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_titanic</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># 好戲登場</span>
<span class="n">new_col</span> <span class="o">=</span> <span class="s1">'存活'</span>
<span class="n">columns</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">new_col</span><span class="p">)</span>  <span class="c1"># 調整欄位順序用</span>
<span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Survived</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">'倖存'</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="s1">'死亡'</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>存活</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>死亡</td>
<td>0</td>
<td>3</td>
<td>male</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>倖存</td>
<td>1</td>
<td>1</td>
<td>female</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>倖存</td>
<td>1</td>
<td>3</td>
<td>female</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>倖存</td>
<td>1</td>
<td>1</td>
<td>female</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>死亡</td>
<td>0</td>
<td>3</td>
<td>male</td>
</tr>
<tr>
<th>5</th>
<td>6</td>
<td>死亡</td>
<td>0</td>
<td>3</td>
<td>male</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>透過 <code>apply</code> 函式，我們把一個匿名函式 <code>lambda</code> 套用到整個 <code>df.Survived</code> Series 之上，並以此建立一個新的 <code>存活</code> 欄位。</p>
<p>值得一提的是當你需要追加新的欄位但又不想影響到原始 DataFrame 時，可以使用 <code>copy</code> 函式複製一份副本另行操作。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="對每一個樣本做自定義運算">對每一個樣本做自定義運算<a class="anchor-link" href="#對每一個樣本做自定義運算">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>上小節我們用 <code>apply</code> 函式對 DataFrame 裡頭的<strong>某個 Series </strong>做運算並生成新欄位：</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Survived</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="o">...</span>
</pre></div>
<p>不過你時常會想要把樣本（row）裡頭的<strong>多個</strong>欄位一次取出做運算並產生一個新的值。這時你可以自定義一個 Python function 並將 <code>apply</code> 函式套用到整個 DataFrame 之上：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_titanic</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># apply custom function 可以說是 pandas 裡最重要的技巧之一</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'male'</span><span class="p">:</span> <span class="s1">'男性'</span><span class="p">,</span> <span class="s1">'female'</span><span class="p">:</span> <span class="s1">'女性'</span><span class="p">}</span> 
<span class="k">def</span> <span class="nf">generate_desc</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">"一名 </span><span class="si">{row['Age']}</span><span class="s2"> 歲的{d[row['Sex']]}"</span>

<span class="n">df</span><span class="p">[</span><span class="s1">'描述'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">generate_desc</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">'Sex'</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>1</td>
<td>3</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
<td>一名 22.0 歲的男性</td>
</tr>
<tr>
<th>1</th>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
<td>一名 38.0 歲的女性</td>
</tr>
<tr>
<th>2</th>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
<td>一名 26.0 歲的女性</td>
</tr>
<tr>
<th>3</th>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
<td>一名 35.0 歲的女性</td>
</tr>
<tr>
<th>4</th>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
<td>一名 35.0 歲的男性</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>此例中 <code>apply</code> 函式將 <code>generate_desc</code> 函式<strong>個別</strong>套用到 DataFrame 裡頭的每一個樣本（row），結合 <code>Sex</code> 及 <code>Age</code> 兩欄位資訊，生成新的 <code>描述</code>。</p>
<p>當然，將 <code>axis</code> 設置為 <code>0</code> 則可以對每一個欄位分別套用自定義的 Python function。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="將連續數值轉換成分類數據">將連續數值轉換成分類數據<a class="anchor-link" href="#將連續數值轉換成分類數據">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>有時你會想把一個連續數值（numerical）的欄位分成多個 groups 以方便對每個 groups 做統計。這時候你可以使用 <code>pd.cut</code> 函式：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_titanic</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># 為了方便比較新舊欄位</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">new_col</span> <span class="o">=</span> <span class="s1">'年齡區間'</span>
<span class="n">columns</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">new_col</span><span class="p">)</span>

<span class="c1"># 將 numerical 轉換成 categorical 欄位</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">'族群 </span><span class="si">{i}</span><span class="s1">'</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>
<span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Age</span><span class="p">,</span> 
                     <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                     <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

<span class="c1"># 可以排序切割後的 categorical 欄位</span>
<span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">new_col</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
   <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
   <span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="n">columns</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>年齡區間</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>631</td>
<td>1</td>
<td>1</td>
<td>male</td>
<td>族群 10</td>
<td>80.0</td>
<td>0</td>
<td>0</td>
<td>27042</td>
<td>30.0000</td>
<td>A23</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>852</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>族群 10</td>
<td>74.0</td>
<td>0</td>
<td>0</td>
<td>347060</td>
<td>7.7750</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>2</th>
<td>55</td>
<td>0</td>
<td>1</td>
<td>male</td>
<td>族群 9</td>
<td>65.0</td>
<td>0</td>
<td>1</td>
<td>113509</td>
<td>61.9792</td>
<td>B30</td>
<td>C</td>
</tr>
<tr>
<th>3</th>
<td>97</td>
<td>0</td>
<td>1</td>
<td>male</td>
<td>族群 9</td>
<td>71.0</td>
<td>0</td>
<td>0</td>
<td>PC 17754</td>
<td>34.6542</td>
<td>A5</td>
<td>C</td>
</tr>
<tr>
<th>4</th>
<td>494</td>
<td>0</td>
<td>1</td>
<td>male</td>
<td>族群 9</td>
<td>71.0</td>
<td>0</td>
<td>0</td>
<td>PC 17609</td>
<td>49.5042</td>
<td>NaN</td>
<td>C</td>
</tr>
<tr>
<th>5</th>
<td>117</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>族群 9</td>
<td>70.5</td>
<td>0</td>
<td>0</td>
<td>370369</td>
<td>7.7500</td>
<td>NaN</td>
<td>Q</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>如上所示，使用 <code>pd.cut</code> 函式建立出來的每個分類 <code>族群 X</code> 有大小之分，因此你可以輕易地使用 <code>sort_values</code> 函式排序樣本。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>CategoricalDtype(categories=['族群 1', '族群 2', '族群 3', '族群 4', '族群 5', '族群 6', '族群 7',
                  '族群 8', '族群 9', '族群 10'],
                 ordered=True)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="將-DataFrame-隨機切成兩個子集">將 DataFrame 隨機切成兩個子集<a class="anchor-link" href="#將-DataFrame-隨機切成兩個子集">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>有時你會想將手上的 DataFrame 隨機切成兩個獨立的子集。選取其中一個子集來訓練機器學習模型是一個常見的情境。</p>
<p>要做到這件事情有很多種方法，你可以使用 <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">scikit-learn 的 <code>train_test_split</code></a> 或是 numpy 的 <code>np.random.randn</code>，但假如你想要純 pandas 解法，可以使用 <code>sample</code> 函式：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_train</span> <span class="o">=</span> <span class="n">df_titanic</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">5566</span><span class="p">)</span>
<span class="n">df_test</span> <span class="o">=</span> <span class="n">df_titanic</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># 顯示結果，無特殊操作</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_test</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'各 DataFrame 大小：'</span><span class="p">,</span> 
      <span class="nb">len</span><span class="p">(</span><span class="n">df_titanic</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>294</th>
<td>295</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>24.0</td>
<td>0</td>
<td>0</td>
<td>349233</td>
<td>7.8958</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>199</th>
<td>200</td>
<td>0</td>
<td>2</td>
<td>female</td>
<td>24.0</td>
<td>0</td>
<td>0</td>
<td>248747</td>
<td>13.0000</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>864</th>
<td>865</td>
<td>0</td>
<td>2</td>
<td>male</td>
<td>24.0</td>
<td>0</td>
<td>0</td>
<td>233866</td>
<td>13.0000</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>625</th>
<td>626</td>
<td>0</td>
<td>1</td>
<td>male</td>
<td>61.0</td>
<td>0</td>
<td>0</td>
<td>36963</td>
<td>32.3208</td>
<td>D50</td>
<td>S</td>
</tr>
<tr>
<th>638</th>
<td>639</td>
<td>0</td>
<td>3</td>
<td>female</td>
<td>41.0</td>
<td>0</td>
<td>5</td>
<td>3101295</td>
<td>39.6875</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>10</th>
<td>11</td>
<td>1</td>
<td>3</td>
<td>female</td>
<td>4.0</td>
<td>1</td>
<td>1</td>
<td>PP 9549</td>
<td>16.7000</td>
<td>G6</td>
<td>S</td>
</tr>
<tr>
<th>11</th>
<td>12</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>58.0</td>
<td>0</td>
<td>0</td>
<td>113783</td>
<td>26.5500</td>
<td>C103</td>
<td>S</td>
</tr>
<tr>
<th>12</th>
<td>13</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>20.0</td>
<td>0</td>
<td>0</td>
<td>A/5. 2151</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>14</th>
<td>15</td>
<td>0</td>
<td>3</td>
<td>female</td>
<td>14.0</td>
<td>0</td>
<td>0</td>
<td>350406</td>
<td>7.8542</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>16</th>
<td>17</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>2.0</td>
<td>4</td>
<td>1</td>
<td>382652</td>
<td>29.1250</td>
<td>NaN</td>
<td>Q</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>各 DataFrame 大小： 891 713 178
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>這個解法的前提是原來的 DataFrame <code>df_titanic</code> 裡頭的索引是獨一無二的。另外記得設定 <code>random_state</code> 以方便別人重現你的結果。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="用-SQL-的方式合併兩個-DataFrames">用 SQL 的方式合併兩個 DataFrames<a class="anchor-link" href="#用-SQL-的方式合併兩個-DataFrames">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>很多時候你會想要將兩個 DataFrames 依照某個共通的欄位（鍵值）合併成單一 DataFrame 以整合資訊。</p>
<p>比方說給定以下兩個 DataFrames：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_city</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">'state'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'密蘇里州'</span><span class="p">,</span> <span class="s1">'亞利桑那州'</span><span class="p">,</span> <span class="s1">'肯塔基州'</span><span class="p">,</span> <span class="s1">'紐約州'</span><span class="p">],</span>
    <span class="s1">'city'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'堪薩斯城'</span><span class="p">,</span> <span class="s1">'鳳凰城'</span><span class="p">,</span> <span class="s1">'路易維爾'</span><span class="p">,</span> <span class="s1">'紐約市'</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">df_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">'city'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'路易維爾'</span><span class="p">,</span> <span class="s1">'堪薩斯城'</span><span class="p">,</span> <span class="s1">'鳳凰城'</span><span class="p">],</span>
    <span class="s1">'population'</span><span class="p">:</span> <span class="p">[</span><span class="mi">741096</span><span class="p">,</span> <span class="mi">481420</span><span class="p">,</span> <span class="mi">4039182</span><span class="p">],</span>
    <span class="s1">'feature'</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">)})</span>

<span class="n">display</span><span class="p">(</span><span class="n">df_city</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_info</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>state</th>
<th>city</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>密蘇里州</td>
<td>堪薩斯城</td>
</tr>
<tr>
<th>1</th>
<td>亞利桑那州</td>
<td>鳳凰城</td>
</tr>
<tr>
<th>2</th>
<td>肯塔基州</td>
<td>路易維爾</td>
</tr>
<tr>
<th>3</th>
<td>紐約州</td>
<td>紐約市</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>city</th>
<th>population</th>
<th>feature</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>路易維爾</td>
<td>741096</td>
<td>a</td>
</tr>
<tr>
<th>1</th>
<td>堪薩斯城</td>
<td>481420</td>
<td>b</td>
</tr>
<tr>
<th>2</th>
<td>鳳凰城</td>
<td>4039182</td>
<td>c</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>DataFrame <code>df_city</code> 包含了幾個美國城市以及其對應的州名（state）；DataFrame <code>df_info</code> 則包含城市名稱以及一些數據。如果你想將這兩個 DataFrames 合併（merge），可以使用非常方便的 <code>merge</code> 函式：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">df_city</span><span class="p">,</span>
         <span class="n">right</span><span class="o">=</span><span class="n">df_info</span><span class="p">,</span>
         <span class="n">how</span><span class="o">=</span><span class="s2">"left"</span><span class="p">,</span> <span class="c1"># left outer join</span>
         <span class="n">on</span><span class="o">=</span><span class="s2">"city"</span><span class="p">,</span> <span class="c1"># 透過此欄位合併</span>
         <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span> <span class="c1"># 顯示結果中每一列的來源</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>state</th>
<th>city</th>
<th>population</th>
<th>feature</th>
<th>_merge</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>密蘇里州</td>
<td>堪薩斯城</td>
<td>481420.0</td>
<td>b</td>
<td>both</td>
</tr>
<tr>
<th>1</th>
<td>亞利桑那州</td>
<td>鳳凰城</td>
<td>4039182.0</td>
<td>c</td>
<td>both</td>
</tr>
<tr>
<th>2</th>
<td>肯塔基州</td>
<td>路易維爾</td>
<td>741096.0</td>
<td>a</td>
<td>both</td>
</tr>
<tr>
<th>3</th>
<td>紐約州</td>
<td>紐約市</td>
<td>NaN</td>
<td>NaN</td>
<td>left_only</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>沒錯，<code>merge</code> 函式運作方式就像 <a href="https://leemeng.tw/why-you-need-to-learn-sql-as-a-data-scientist.html">SQL</a> 一樣，可以讓你透過更改 <code>how</code> 參數來做：</p>
<ul>
<li><code>left</code>：left outer join</li>
<li><code>right</code>：right outer join</li>
<li><code>outer</code>: full outer join</li>
<li><code>inner</code>： inner join</li>
</ul>
<p>注意合併後的 DataFrame 的最後一列：因為是 left join，就算右側的 <code>df_info</code> 裡頭並沒有紐約市的資訊，我們也能把該城市保留在 <code>merge</code> 後的結果。你還可以透過 <code>indicator=True</code> 的方式讓 pandas 幫我們新增一個 <code>_merge</code> 欄位，輕鬆了解紐約市只存在左側的 <code>df_city</code> 裡。</p>
<p><code>merge</code> 函式強大之處在於能跟 SQL 一樣為我們抽象化如何合併兩個 DataFrames 的運算。如果你想要了解 SQL 跟 Python 本質上的差異，可以參考<a href="https://leemeng.tw/why-you-need-to-learn-sql-as-a-data-scientist.html">為何資料科學家需要學習 SQL</a> 一文。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="存取並操作每一個樣本">存取並操作每一個樣本<a class="anchor-link" href="#存取並操作每一個樣本">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>我們前面看過，雖然一般可以直接使用 <a href="#對某一軸套用相同運算"><code>apply</code> 函式</a>來對每個樣本作運算，有時候你就是會想用 for 迴圈的方式把每個樣本取出處理。</p>
<p>這種時候你可以用 <code>itertuples</code> 函式：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_city</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'City'</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{row.city}</span><span class="s1">是</span><span class="si">{row.state}</span><span class="s1">裡頭的一個城市'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>堪薩斯城是密蘇里州裡頭的一個城市
鳳凰城是亞利桑那州裡頭的一個城市
路易維爾是肯塔基州裡頭的一個城市
紐約市是紐約州裡頭的一個城市
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>顧名思義，<code>itertuples</code> 函式回傳的是 Python <a href="https://docs.python.org/3/library/collections.html#collections.namedtuple">namedtuple</a>，也是一個你應該已經很熟悉的資料型態：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="n">City</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'City'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'Index'</span><span class="p">,</span> <span class="s1">'state'</span><span class="p">,</span> <span class="s1">'city'</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">City</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">'紐約州'</span><span class="p">,</span> <span class="s1">'紐約市'</span><span class="p">)</span>
<span class="n">c</span> <span class="o">==</span> <span class="n">row</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="簡單匯總-&amp;-分析數據_1">簡單匯總 &amp; 分析數據<a class="anchor-link" href="#簡單匯總-&amp;-分析數據">&para;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在對數據做些基本處理以後，你會想要從手上的 DataFrame 匯總或整理出一些有用的統計數據。本節介紹一些常用的數據匯總技巧。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="取出某欄位-top-k-的值">取出某欄位 top k 的值<a class="anchor-link" href="#取出某欄位-top-k-的值">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>這你在<a href="#選取某欄位為-top-k-值的樣本">選取某欄位為 top-k 值的樣本</a>小節應該就看過了。</p>
<p>但因為這個使用情境實在太常出現，讓我們再次嘗試將鐵達尼號數據集裡頭 <code>Ticket</code> 欄位最常出現的值取出：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_titanic</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Ticket</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>1</td>
<td>3</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>index</th>
<th>Ticket</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>347082</td>
<td>7</td>
</tr>
<tr>
<th>1</th>
<td>1601</td>
<td>7</td>
</tr>
<tr>
<th>2</th>
<td>CA. 2343</td>
<td>7</td>
</tr>
<tr>
<th>3</th>
<td>3101295</td>
<td>6</td>
</tr>
<tr>
<th>4</th>
<td>CA 2144</td>
<td>6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>value_counts</code> 函式預設就會把欄位裡頭的值依照出現頻率<strong>由高到低</strong>排序，因此搭配 <code>head</code> 函式就可以把最常出現的 top k 值選出。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="一行描述數值欄位">一行描述數值欄位<a class="anchor-link" href="#一行描述數值欄位">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>當你想要快速了解 DataFrame 裡所有數值欄位的統計數據（最小值、最大值、平均和中位數等）時可以使用 <code>describe</code> 函式：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Fare</th>
</tr>
</thead>
<tbody>
<tr>
<th>count</th>
<td>891.000000</td>
<td>891.000000</td>
<td>891.000000</td>
<td>714.000000</td>
<td>891.000000</td>
<td>891.000000</td>
<td>891.000000</td>
</tr>
<tr>
<th>mean</th>
<td>446.000000</td>
<td>0.383838</td>
<td>2.308642</td>
<td>29.699118</td>
<td>0.523008</td>
<td>0.381594</td>
<td>32.204208</td>
</tr>
<tr>
<th>std</th>
<td>257.353842</td>
<td>0.486592</td>
<td>0.836071</td>
<td>14.526497</td>
<td>1.102743</td>
<td>0.806057</td>
<td>49.693429</td>
</tr>
<tr>
<th>min</th>
<td>1.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>0.420000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr>
<th>25%</th>
<td>223.500000</td>
<td>0.000000</td>
<td>2.000000</td>
<td>20.125000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>7.910400</td>
</tr>
<tr>
<th>50%</th>
<td>446.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>28.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>14.454200</td>
</tr>
<tr>
<th>75%</th>
<td>668.500000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>38.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>31.000000</td>
</tr>
<tr>
<th>max</th>
<td>891.000000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>80.000000</td>
<td>8.000000</td>
<td>6.000000</td>
<td>512.329200</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你也可以用<a href="#取得想要關注的數據_1">取得想要關注的數據</a>一節的技巧來選取自己關心的統計數據：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">'mean'</span><span class="p">,</span> <span class="s1">'std'</span><span class="p">],</span> <span class="s1">'Survived'</span><span class="p">:</span><span class="s1">'Age'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Survived</th>
<th>Pclass</th>
<th>Age</th>
</tr>
</thead>
<tbody>
<tr>
<th>mean</th>
<td>0.383838</td>
<td>2.308642</td>
<td>29.699118</td>
</tr>
<tr>
<th>std</th>
<td>0.486592</td>
<td>0.836071</td>
<td>14.526497</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="找出欄位裡所有出現過的值">找出欄位裡所有出現過的值<a class="anchor-link" href="#找出欄位裡所有出現過的值">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>針對特定欄位使用 <code>unique</code> 函式即可：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">Sex</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>array(['male', 'female'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="分組匯總結果">分組匯總結果<a class="anchor-link" href="#分組匯總結果">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>很多時候你會想要把 DataFrame 裡頭的樣本依照某些特性分門別類，並依此匯總各組（group）的統計數據。這種時候你可以用 <code>groupby</code> 函式。</p>
<p>讓我們再次拿出鐵達尼號數據集：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_titanic</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>1</td>
<td>3</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你可以將所有乘客（列）依照它們的 <code>Pclass</code> 欄位值分組，並計算每組裡頭乘客們的平均年齡：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"Pclass"</span><span class="p">)</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>Pclass
1    38.233441
2    29.877630
3    25.140620
Name: Age, dtype: float64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你也可以搭配剛剛看過的 <code>describe</code> 函式來匯總各組的統計數據：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"Sex"</span><span class="p">)</span><span class="o">.</span><span class="n">Survived</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>count</th>
<th>mean</th>
<th>std</th>
<th>min</th>
<th>25%</th>
<th>50%</th>
<th>75%</th>
<th>max</th>
</tr>
<tr>
<th>Sex</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>female</th>
<td>314.0</td>
<td>0.742038</td>
<td>0.438211</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr>
<th>male</th>
<td>577.0</td>
<td>0.188908</td>
<td>0.391775</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你也可以依照多個欄位分組，並利用 <code>size</code> 函式迅速地取得各組包含的樣本數：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">"Sex"</span><span class="p">,</span> <span class="s1">'Pclass'</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th>Pclass</th>
<th>1</th>
<th>2</th>
<th>3</th>
</tr>
<tr>
<th>Sex</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>female</th>
<td>94</td>
<td>76</td>
<td>144</td>
</tr>
<tr>
<th>male</th>
<td>122</td>
<td>108</td>
<td>347</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你也可以用 <code>agg</code> 函式（<strong>agg</strong>regate，匯總）搭配 <code>groupby</code> 函式來將每一組樣本依照多種方式匯總：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">"Sex"</span><span class="p">,</span> <span class="s1">'Pclass'</span><span class="p">])</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">'min'</span><span class="p">,</span> <span class="s1">'max'</span><span class="p">,</span> <span class="s1">'count'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>min</th>
<th>max</th>
<th>count</th>
</tr>
<tr>
<th>Sex</th>
<th>Pclass</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="3" valign="top">female</th>
<th>1</th>
<td>2.00</td>
<td>63.0</td>
<td>85</td>
</tr>
<tr>
<th>2</th>
<td>2.00</td>
<td>57.0</td>
<td>74</td>
</tr>
<tr>
<th>3</th>
<td>0.75</td>
<td>63.0</td>
<td>102</td>
</tr>
<tr>
<th rowspan="3" valign="top">male</th>
<th>1</th>
<td>0.92</td>
<td>80.0</td>
<td>101</td>
</tr>
<tr>
<th>2</th>
<td>0.67</td>
<td>70.0</td>
<td>99</td>
</tr>
<tr>
<th>3</th>
<td>0.42</td>
<td>74.0</td>
<td>253</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>透過 <code>unstack</code> 函式能讓你產生跟 <code>pivot_table</code> 函式相同的結果：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">"Sex"</span><span class="p">,</span> <span class="s1">'Pclass'</span><span class="p">])</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">'min'</span><span class="p">,</span> <span class="s1">'max'</span><span class="p">,</span> <span class="s1">'count'</span><span class="p">])</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr>
<th></th>
<th colspan="3" halign="left">min</th>
<th colspan="3" halign="left">max</th>
<th colspan="3" halign="left">count</th>
</tr>
<tr>
<th>Pclass</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>1</th>
<th>2</th>
<th>3</th>
</tr>
<tr>
<th>Sex</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>female</th>
<td>2.00</td>
<td>2.00</td>
<td>0.75</td>
<td>63.0</td>
<td>57.0</td>
<td>63.0</td>
<td>85</td>
<td>74</td>
<td>102</td>
</tr>
<tr>
<th>male</th>
<td>0.92</td>
<td>0.67</td>
<td>0.42</td>
<td>80.0</td>
<td>70.0</td>
<td>74.0</td>
<td>101</td>
<td>99</td>
<td>253</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>當然，你也可以直接使用 <code>pivot_table</code> 函式來匯總各組數據：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">'Sex'</span><span class="p">,</span> 
               <span class="n">columns</span><span class="o">=</span><span class="s1">'Pclass'</span><span class="p">,</span> 
               <span class="n">values</span><span class="o">=</span><span class="s1">'Age'</span><span class="p">,</span> 
               <span class="n">aggfunc</span><span class="o">=</span><span class="p">[</span><span class="s1">'min'</span><span class="p">,</span> <span class="s1">'max'</span><span class="p">,</span> <span class="s1">'count'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr>
<th></th>
<th colspan="3" halign="left">min</th>
<th colspan="3" halign="left">max</th>
<th colspan="3" halign="left">count</th>
</tr>
<tr>
<th>Pclass</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>1</th>
<th>2</th>
<th>3</th>
</tr>
<tr>
<th>Sex</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>female</th>
<td>2.00</td>
<td>2.00</td>
<td>0.75</td>
<td>63.0</td>
<td>57.0</td>
<td>63.0</td>
<td>85</td>
<td>74</td>
<td>102</td>
</tr>
<tr>
<th>male</th>
<td>0.92</td>
<td>0.67</td>
<td>0.42</td>
<td>80.0</td>
<td>70.0</td>
<td>74.0</td>
<td>101</td>
<td>99</td>
<td>253</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>依照背景不同，每個人會有偏好的 pandas 使用方式。選擇對你來說最直覺又好記的方式吧！</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="結合原始數據與匯總結果">結合原始數據與匯總結果<a class="anchor-link" href="#結合原始數據與匯總結果">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>不管是上節的 <code>groupby</code> 搭配 <code>agg</code> 還是 <code>pivot_table</code>，匯總結果都會以另外一個全新的 DataFrame 表示。</p>
<p>有時候你會想直接把各組匯總的結果放到原本的 DataFrame 裡頭，方便比較原始樣本與匯總結果的差異。這時你可以使用 <code>transform</code> 函式：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_titanic</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'Avg_age'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"Sex"</span><span class="p">)</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s2">"mean"</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'Above_avg_age'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">'yes'</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">Age</span> <span class="o">&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg_age</span> <span class="k">else</span> <span class="s1">'no'</span><span class="p">,</span> 
                               <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># styling</span>
<span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">'Sex'</span><span class="p">:]</span>
 <span class="o">.</span><span class="n">style</span>
 <span class="o">.</span><span class="n">highlight_max</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'Avg_age'</span><span class="p">])</span>
 <span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">'background-color: rgb(153, 255, 51)'</span><span class="p">,</span> 
           <span class="n">subset</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="s1">'Age'</span><span class="p">,</span> <span class="s1">'Above_avg_age'</span><span class="p">]])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<style type="text/css">
    #T_51aa6300_b014_11e9_8b6c_8c8590794fe2row0_col1 {
            background-color:  rgb(153, 255, 51);
        }    #T_51aa6300_b014_11e9_8b6c_8c8590794fe2row0_col8 {
            background-color:  yellow;
        }    #T_51aa6300_b014_11e9_8b6c_8c8590794fe2row0_col9 {
            background-color:  rgb(153, 255, 51);
        }    #T_51aa6300_b014_11e9_8b6c_8c8590794fe2row4_col1 {
            background-color:  rgb(153, 255, 51);
        }    #T_51aa6300_b014_11e9_8b6c_8c8590794fe2row4_col8 {
            background-color:  yellow;
        }    #T_51aa6300_b014_11e9_8b6c_8c8590794fe2row4_col9 {
            background-color:  rgb(153, 255, 51);
        }</style><table class="table table-striped table-responsive" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2"><thead> <tr> <th class="blank level0"></th> <th class="col_heading level0 col0">Sex</th> <th class="col_heading level0 col1">Age</th> <th class="col_heading level0 col2">SibSp</th> <th class="col_heading level0 col3">Parch</th> <th class="col_heading level0 col4">Ticket</th> <th class="col_heading level0 col5">Fare</th> <th class="col_heading level0 col6">Cabin</th> <th class="col_heading level0 col7">Embarked</th> <th class="col_heading level0 col8">Avg_age</th> <th class="col_heading level0 col9">Above_avg_age</th> </tr></thead><tbody>
<tr>
<th class="row_heading level0 row0" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2level0_row0">0</th>
<td class="data row0 col0" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row0_col0">male</td>
<td class="data row0 col1" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row0_col1">22</td>
<td class="data row0 col2" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row0_col2">1</td>
<td class="data row0 col3" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row0_col3">0</td>
<td class="data row0 col4" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row0_col4">A/5 21171</td>
<td class="data row0 col5" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row0_col5">7.25</td>
<td class="data row0 col6" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row0_col6">nan</td>
<td class="data row0 col7" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row0_col7">S</td>
<td class="data row0 col8" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row0_col8">30.7266</td>
<td class="data row0 col9" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row0_col9">no</td>
</tr>
<tr>
<th class="row_heading level0 row1" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2level0_row1">1</th>
<td class="data row1 col0" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row1_col0">female</td>
<td class="data row1 col1" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row1_col1">38</td>
<td class="data row1 col2" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row1_col2">1</td>
<td class="data row1 col3" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row1_col3">0</td>
<td class="data row1 col4" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row1_col4">PC 17599</td>
<td class="data row1 col5" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row1_col5">71.2833</td>
<td class="data row1 col6" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row1_col6">C85</td>
<td class="data row1 col7" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row1_col7">C</td>
<td class="data row1 col8" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row1_col8">27.9157</td>
<td class="data row1 col9" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row1_col9">yes</td>
</tr>
<tr>
<th class="row_heading level0 row2" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2level0_row2">2</th>
<td class="data row2 col0" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row2_col0">female</td>
<td class="data row2 col1" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row2_col1">26</td>
<td class="data row2 col2" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row2_col2">0</td>
<td class="data row2 col3" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row2_col3">0</td>
<td class="data row2 col4" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row2_col4">STON/O2. 3101282</td>
<td class="data row2 col5" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row2_col5">7.925</td>
<td class="data row2 col6" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row2_col6">nan</td>
<td class="data row2 col7" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row2_col7">S</td>
<td class="data row2 col8" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row2_col8">27.9157</td>
<td class="data row2 col9" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row2_col9">no</td>
</tr>
<tr>
<th class="row_heading level0 row3" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2level0_row3">3</th>
<td class="data row3 col0" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row3_col0">female</td>
<td class="data row3 col1" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row3_col1">35</td>
<td class="data row3 col2" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row3_col2">1</td>
<td class="data row3 col3" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row3_col3">0</td>
<td class="data row3 col4" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row3_col4">113803</td>
<td class="data row3 col5" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row3_col5">53.1</td>
<td class="data row3 col6" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row3_col6">C123</td>
<td class="data row3 col7" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row3_col7">S</td>
<td class="data row3 col8" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row3_col8">27.9157</td>
<td class="data row3 col9" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row3_col9">yes</td>
</tr>
<tr>
<th class="row_heading level0 row4" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2level0_row4">4</th>
<td class="data row4 col0" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row4_col0">male</td>
<td class="data row4 col1" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row4_col1">35</td>
<td class="data row4 col2" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row4_col2">0</td>
<td class="data row4 col3" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row4_col3">0</td>
<td class="data row4 col4" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row4_col4">373450</td>
<td class="data row4 col5" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row4_col5">8.05</td>
<td class="data row4 col6" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row4_col6">nan</td>
<td class="data row4 col7" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row4_col7">S</td>
<td class="data row4 col8" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row4_col8">30.7266</td>
<td class="data row4 col9" id="T_51aa6300_b014_11e9_8b6c_8c8590794fe2row4_col9">yes</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>此例將所有乘客依照性別 <code>Sex</code> 分組之後，計算各組的平均年齡 <code>Age</code>，並利用 <code>transform</code> 函式將各組結果插入對應的乘客（列）裡頭。你會發現兩名男乘客跟平均男性壽命 <code>Avg_age</code> 欄位相比正好一上一下，這差異則反映到 <code>Above_avg_age</code> 欄位裡頭。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="對時間數據做匯總">對時間數據做匯總<a class="anchor-link" href="#對時間數據做匯總">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>給定一個跟時間相關的 DataFrame：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">makeTimeDataFrame</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">'Q'</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
<span class="n">df_date</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<th>2000-03-31</th>
<td>-20.465499</td>
<td>-5.402825</td>
<td>4.790400</td>
<td>-6.949846</td>
</tr>
<tr>
<th>2000-06-30</th>
<td>-3.573217</td>
<td>2.091491</td>
<td>12.725446</td>
<td>-10.215842</td>
</tr>
<tr>
<th>2000-09-30</th>
<td>-3.377268</td>
<td>3.600146</td>
<td>13.607341</td>
<td>6.309234</td>
</tr>
<tr>
<th>2000-12-31</th>
<td>-11.181567</td>
<td>-16.471324</td>
<td>8.659892</td>
<td>5.619725</td>
</tr>
<tr>
<th>2001-03-31</th>
<td>7.148111</td>
<td>8.887097</td>
<td>-0.117279</td>
<td>-1.628799</td>
</tr>
<tr>
<th>2001-06-30</th>
<td>9.765045</td>
<td>-1.160198</td>
<td>4.898406</td>
<td>12.054339</td>
</tr>
<tr>
<th>2001-09-30</th>
<td>-8.067456</td>
<td>-9.746304</td>
<td>-12.500050</td>
<td>-8.970445</td>
</tr>
<tr>
<th>2001-12-31</th>
<td>-3.300273</td>
<td>-11.148755</td>
<td>-13.194654</td>
<td>12.852938</td>
</tr>
<tr>
<th>2002-03-31</th>
<td>-6.421518</td>
<td>12.420474</td>
<td>-3.546766</td>
<td>20.694348</td>
</tr>
<tr>
<th>2002-06-30</th>
<td>11.967359</td>
<td>9.522958</td>
<td>1.557142</td>
<td>-2.778456</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你可以利用 <code>resample</code> 函式來依照不同時間粒度匯總這個時間 DataFrame：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">df_date</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">'Y'</span><span class="p">)</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
 <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
 <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">'index'</span><span class="p">:</span> <span class="s1">'year'</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>year</th>
<th>A</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2000-12-31</td>
<td>-3.377268</td>
</tr>
<tr>
<th>1</th>
<td>2001-12-31</td>
<td>9.765045</td>
</tr>
<tr>
<th>2</th>
<td>2002-12-31</td>
<td>11.967359</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>此例中將不同年份（<strong>Y</strong>ear）的樣本分組，並從每一組的欄位 <code>A</code> 中選出最大值。你可以查看<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#resampling">官方 resampling 說明文件</a>來了解還有什麼時間粒度可以選擇（分鐘、小時、月份等等）。</p>
<p>另外小細節是你可以利用 <a href="https://numpy.org/devdocs/user/theory.broadcasting.html">numpy 的 broadcasting 運算</a>輕鬆地將 DataFrame 裡的所有數值做操作（初始 <code>df_date</code> 時的用到的 <code>* 10</code>）。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="簡易繪圖並修改預設樣式">簡易繪圖並修改預設樣式<a class="anchor-link" href="#簡易繪圖並修改預設樣式">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在 Python 世界裡有很多數據視覺化工具供你選擇，比方說經典的 <a href="https://matplotlib.org/">Matplotlib</a> 以及在<a href="https://leemeng.tw/neural-machine-translation-with-transformer-and-tensorflow2.html">淺談神經機器翻譯一文</a>中被我拿來視覺化矩陣運算的 <a href="https://seaborn.pydata.org/">Seaborn</a>。你也可以使用前面看過的 <a href="https://leemeng.tw/chartify-a-simple-yet-powerful-python-data-visualization-tool-which-boost-your-productivity-as-a-data-scientist.html">Chartify</a> 搭配 pandas 畫出美麗圖表。</p>
<p>但有時，你只需要 pandas 內建的 <code>plot</code> 函式就能輕鬆地將一個 DataFrame 轉成統計圖：</p>
<div class="highlight"><pre><span></span><span class="c1"># 用 `plot` 一行畫圖。前兩行只是改變預設樣式</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"ggplot"</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"Pclass"</span><span class="p">)</span><span class="o">.</span><span class="n">Survived</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">"barh"</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<img src="https://leemeng.tw/images/pandas/pandas_plot.jpg" style="mix-blend-mode: initial;"/>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>我們都是視覺動物，pandas 的 <code>plot</code> 函式讓你在進行<a href="https://en.wikipedia.org/wiki/Exploratory_data_analysis">探索型數據分析（<strong>E</strong>xploratory <strong>D</strong>ata <strong>A</strong>nalysis, EDA）</a>、試著快速了解手上數據集時十分方便。我們在<a href="https://leemeng.tw/data-visualization-from-matplotlib-to-ggplot2.html">淺談資料視覺化以及 ggplot2 實踐</a>一文也已經探討過類似概念：</p>
<p><br/></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<center>
<img src="https://leemeng.tw/images/ggplot2/data-vis-purpose.png" style="mix-blend-mode: initial;"/>
</center>
<center>
                        在做 EDA 時只需要包含最重要且你自己能夠解讀的視覺變數，重點是效率
                        （<a href="https://leemeng.tw/data-visualization-from-matplotlib-to-ggplot2.html" target="_blank">圖片來源</a>）
                        
                        <br/>
<br/>
</center>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br/></p>
<p>另外 pandas 底層預設使用 Matplotlib 繪圖，而用過 Matplotlib 的人都知道其初始的繪圖樣式實在不太討喜。你可以透過 <code>plt.style.available</code> 查看所有可供使用的繪圖樣式（style），並將喜歡的樣式透過 <code>plt.style.use()</code> 套用到所有 DataFrames 的 <code>plot</code> 函式：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">available</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>['seaborn-dark',
 'seaborn-darkgrid',
 'seaborn-ticks',
 'fivethirtyeight',
 'seaborn-whitegrid',
 'classic',
 '_classic_test',
 'fast',
 'seaborn-talk',
 'seaborn-dark-palette',
 'seaborn-bright',
 'seaborn-pastel',
 'grayscale',
 'seaborn-notebook',
 'ggplot',
 'seaborn-colorblind',
 'seaborn-muted',
 'seaborn',
 'Solarize_Light2',
 'seaborn-paper',
 'bmh',
 'tableau-colorblind10',
 'seaborn-white',
 'dark_background',
 'seaborn-poster',
 'seaborn-deep']</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="與-pandas-相得益彰的實用工具_1">與 pandas 相得益彰的實用工具<a class="anchor-link" href="#與-pandas-相得益彰的實用工具">&para;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>前面幾個章節介紹了不少 pandas 的使用技巧與操作概念，這節則介紹一些我認為十分適合跟 pandas 一起搭配使用的數據工具 / 函式庫。在說明每個工具的功能時，我都會使用你已經十分熟悉的鐵達尼號數據集作為範例 DataFrame：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_titanic</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>PassengerId</th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>1</td>
<td>3</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="tqdm：了解你的數據處理進度"><a href="https://github.com/tqdm/tqdm">tqdm</a>：了解你的數據處理進度<a class="anchor-link" href="#tqdm：了解你的數據處理進度">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://github.com/tqdm/tqdm">tqdm</a> 是一個十分強大的 Python 進度條工具，且有<a href="https://github.com/tqdm/tqdm#pandas-integration">整合 pandas</a>。此工具可以幫助我們了解 DataFrame <code>apply</code> 函式的進度。回想一下我們在<a href="#對某一軸套用相同運算">對某一軸套用相同運算</a>一節做的一個簡單 <code>apply</code> 運算：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'存活'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Survived</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">'倖存'</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="s1">'死亡'</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">'Survived'</span><span class="p">:</span><span class="s1">'存活'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe table table-striped table-responsive">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Survived</th>
<th>Pclass</th>
<th>Sex</th>
<th>Age</th>
<th>SibSp</th>
<th>Parch</th>
<th>Ticket</th>
<th>Fare</th>
<th>Cabin</th>
<th>Embarked</th>
<th>存活</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>3</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
<td>死亡</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>1</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
<td>倖存</td>
</tr>
<tr>
<th>2</th>
<td>1</td>
<td>3</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
<td>倖存</td>
</tr>
<tr>
<th>3</th>
<td>1</td>
<td>1</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
<td>倖存</td>
</tr>
<tr>
<th>4</th>
<td>0</td>
<td>3</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
<td>死亡</td>
</tr>
<tr>
<th>5</th>
<td>0</td>
<td>3</td>
<td>male</td>
<td>NaN</td>
<td>0</td>
<td>0</td>
<td>330877</td>
<td>8.4583</td>
<td>NaN</td>
<td>Q</td>
<td>死亡</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在這個不到 1,000 筆的 DataFrame 做這樣的簡單運算不用一秒鐘，但實務上你可能常常需要對幾十萬、幾百萬筆數據分別做複雜的運算，這時候了解執行進度就是一件非常重要的事情。首先透過 <a href="https://www.anaconda.com/">Anaconda</a> 安裝 tqdm：</p>
<div class="highlight"><pre><span></span>conda install -c conda-forge tqdm
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>如果你是在 Juypter 筆記本裡執行 pandas，可以用以下的方式將 tqdm 進度條整合到 <code>apply</code> 函式：</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm_notebook</span>
<span class="n">tqdm_notebook</span><span class="p">()</span><span class="o">.</span><span class="n">pandas</span><span class="p">()</span>
<span class="n">clear_output</span><span class="p">()</span>

<span class="c1"># 只需將 `apply` 替換成 `progress_apply`</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'存活'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Survived</span><span class="o">.</span><span class="n">progress_apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">'倖存'</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="s1">'死亡'</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">'Survived'</span><span class="p">:</span><span class="s1">'存活'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<img src="https://leemeng.tw/images/pandas/tqdm_progress_apply.jpg" style="mix-blend-mode: initial;"/>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>透過使用 <code>progress_apply</code> 函式，我們可以得到跟使用 <code>apply</code> 函式一樣的結果，附贈進度條。相信我，在你 <code>apply</code> 的函式很複雜且樣本數很大時，你會很感謝有進度條的存在。你可以查看 <a href="https://github.com/tqdm/tqdm">tqdm repo</a> 了解更多使用案例：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<img src="https://leemeng.tw/images/pandas/tqdm-jupyter-1.gif" style="mix-blend-mode: initial;"/>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="swifter：加速你的數據處理"><a href="https://github.com/jmcarpenter2/swifter">swifter</a>：加速你的數據處理<a class="anchor-link" href="#swifter：加速你的數據處理">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://github.com/jmcarpenter2/swifter">swifter</a> 函式庫能以最有效率的方式執行 <code>apply</code> 函式。同樣可以使用 Anaconda 安裝：</p>
<div class="highlight"><pre><span></span>conda install -c conda-forge swifter
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>接著讓我建立一個有 100 萬筆樣本的 DataFrame ，測試 swifter 與原版 <code>apply</code> 函式的效能差異：</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">swifter</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000000</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'x'</span><span class="p">])</span>

<span class="o">%</span><span class="k">timeit</span> -n 10 df['x2'] = df['x'].apply(lambda x: x**2)
<span class="o">%</span><span class="k">timeit</span> -n 10 df['x2'] = df['x'].swifter.apply(lambda x: x**2)
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>240 ms &plusmn; 5.24 ms per loop (mean &plusmn; std. dev. of 7 runs, 10 loops each)
5 ms &plusmn; 565 &micro;s per loop (mean &plusmn; std. dev. of 7 runs, 10 loops each)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在這個簡單的平方運算中，swifter 版的 <code>apply</code> 函式在我的 mac 上的效率是原始 <code>apply</code> 函式的 48 倍。而要使用 swifter 你也只需要加上 <code>swifter</code> 關鍵字即可，何樂而不為？</p>
<p>喔別擔心，剛剛的 tqdm 進度條仍然會繼續顯示：</p>
<div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'x'</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'x2'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'x'</span><span class="p">]</span><span class="o">.</span><span class="n">swifter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<img src="https://leemeng.tw/images/pandas/swifter_with_tqdm.png" style="mix-blend-mode: initial;"/>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>魚與熊掌兩者皆得。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="qgrid：即時排序、篩選及編輯你的-DataFrame"><a href="https://github.com/quantopian/qgrid">qgrid</a>：即時排序、篩選及編輯你的 DataFrame<a class="anchor-link" href="#qgrid：即時排序、篩選及編輯你的-DataFrame">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://github.com/quantopian/qgrid">qgrid</a> 是一個能讓你在 Jupyter 筆記本裡使用簡單 UI 瀏覽並操作 DataFrame 的 widget。一樣透過 Anaconda 安裝：</p>
<div class="highlight"><pre><span></span>conda install -c tim_shawver qgrid
jupyter nbextension <span class="nb">enable</span> --py --sys-prefix widgetsnbextension
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>實際的使用方式也非常簡單：</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">qgrid</span>
<span class="n">qgrid</span><span class="o">.</span><span class="n">set_grid_option</span><span class="p">(</span><span class="s1">'maxVisibleRows'</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">qgrid</span><span class="o">.</span><span class="n">show_grid</span><span class="p">(</span><span class="n">df_titanic</span><span class="p">)</span>
<span class="n">q</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<video autoplay="" loop="" muted="" playsinline="" poster="https://leemeng.tw/20190721_practical_pandas_tutorial_for_aspiring_data_scientists.ipynb" style="mix-blend-mode: initial;">
<source src="https://leemeng.tw/images/pandas/qgrid_demo.mp4" type="video/mp4"/>
                    您的瀏覽器不支援影片標籤，請留言通知我：S
                </video>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你可以簡單瀏覽 DataFrame 內容，也能依照欄位值篩選及排序樣本，甚至編輯裡頭的值。</p>
<p>如果你想要取得當前狀態的 DataFrame，也能使用 qgrid 裡頭的 <code>get_changed_df</code> 函式：</p>
<div class="highlight"><pre><span></span><span class="c1"># 取得更改後的 DataFrame</span>
<span class="n">df_changed</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get_changed_df</span><span class="p">()</span>

<span class="c1"># styling</span>
<span class="p">(</span><span class="n">df_changed</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">8</span><span class="p">,</span> <span class="p">:]</span>
 <span class="o">.</span><span class="n">style</span>
 <span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">'color:red'</span><span class="p">,</span>
           <span class="n">subset</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[</span><span class="mi">829</span><span class="p">,</span> <span class="s1">'SibSp'</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<img src="https://leemeng.tw/images/pandas/qgrid_get_changed_df.png" style="mix-blend-mode: initial;"/>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>注意我剛剛在 qgrid 裡頭將 <code>0</code> 改成 <code>2</code>，而這個變動被反映到新的 DataFrame <code>df_changed</code> 裡頭。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="pandas-profiling：你的一鍵-EDA-神器"><a href="https://github.com/pandas-profiling/pandas-profiling">pandas-profiling</a>：你的一鍵 EDA 神器<a class="anchor-link" href="#pandas-profiling：你的一鍵-EDA-神器">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>廢話不多說，先附上安裝指令：</p>
<div class="highlight"><pre><span></span>conda install -c conda-forge pandas-profiling
</pre></div>
<p>當碰到新的資料集時，你常會需要做 EDA 來探索並了解手上的數據。常見的基礎步驟有：</p>
<ul>
<li>隨機抽樣 DataFrame 並用肉眼觀察樣本</li>
<li>了解樣本數有多少、各類型的變數有多少</li>
<li>了解 DataFrame 裡有多少空值</li>
<li>看數值欄位的分佈，欄位之間的相關係數</li>
<li>看分類型欄位的有多少不同的值，分佈為何</li>
</ul>
<p>等等。這些在你熟悉本文的 pandas 技巧以後都應該跟吃飯喝水一樣，但很多時候就是例行公事。</p>
<p>這時你可以使用 <a href="https://github.com/pandas-profiling/pandas-profiling">pandas-profiling</a> 讓它自動產生簡單報表，總結 DataFrame 裡的數據性質：</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas_profiling</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_titanic</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># 一行報表：將想觀察的 DataFrame 丟進去就完工了</span>
<span class="n">pandas_profiling</span><span class="o">.</span><span class="n">ProfileReport</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<video autoplay="" loop="" muted="" playsinline="" poster="https://leemeng.tw/20190721_practical_pandas_tutorial_for_aspiring_data_scientists.ipynb" style="mix-blend-mode: initial;">
<source src="https://leemeng.tw/images/pandas/pandas_profiling.mp4" type="video/mp4"/>
                    您的瀏覽器不支援影片標籤，請留言通知我：S
                </video>
<br/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>有了自動生成的數據分析報表，你不再需要自己寫繁瑣的程式碼就能「健檢」手上的數據集。這讓你能對數據更快地展開 domain-specific 的研究與分析，大大提升效率。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="結語：實際運用所學_1">結語：實際運用所學<a class="anchor-link" href="#結語：實際運用所學">&para;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>呼！本文的 pandas 旅程到此告一段落啦！</p>
<p>我想在其他地方你應該是找不到跟本文一樣囉哩八唆的 pandas 教學文章了。本文雖長，但涵蓋的都是我認為十分實用的 pandas 使用手法，希望你有從中學到些東西，並開始自己的數據處理與分析之旅。如果你之後想要複習，可以點開頁面左側的章節傳送門，測試自己還記得多少技巧。</p>
<p>接下來最重要的是培養你自己的 pandas <strong>肌肉記憶</strong>：重複應用你在本文學到的東西，分析自己感興趣的任何數據並內化這些知識。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<center>
<img src="https://leemeng.tw/images/pandas/danial-ricaros-FCHlYvR5gJI-unsplash.jpg"/>
</center>
<center>
                        Now it's your show time
                        <br/>
<br/>
</center>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>pandas 是一個非常強大的資料處理工具，本文雖長，仍無法涵蓋所有東西。不過你現在已經學會作為一個資料科學家所需要的所有基礎 pandas 手法。除了多加練習找手感以外，我能給你的最後一個建議就是在 Jupyter 筆記本裡頭多加利用 <code>Shift</code> + <code>tab</code> 查看 pandas 函式的 documentation，很多時候你會有新的發現。</p>
<p>如果你有任何其他 pandas 技巧，也請不吝留言與我分享！我懂的技巧不多，而現在輪到你教我了：）</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>


                <!-- Tags -->
                <p class="blog-content__tags">
                    <span>Post Tags</span>

                    <span class="blog-content__tag-list">
                        <a href="https://leemeng.tw/tag/zi-liao-ke-xue.html" rel="tag">資料科學</a>
                        <a href="https://leemeng.tw/tag/python.html" rel="tag">Python</a>
                        <a href="https://leemeng.tw/tag/pandas.html" rel="tag">pandas</a>
                    </span>

                </p>











                <!-- end Tags -->


                <!-- Mail-list-subscribe -->
                <div id="article-inner-subscribe" class="blog-content__pagenav">
                    <div class="blog-content__nav">
                        <div class="blog-content__prev">
                            <a class="open-popup" rel="subscribe">
                                <span>Get Latest Arrivals</span>
                                訂閱最新文章
                            </a>
                        </div>
                        <div class="blog-content__next">
                            <p>
                                跟資料科學相關的最新文章直接送到家。</br>
                                只要加入訂閱名單，當新文章出爐時，</br>
                                你將能馬上收到通知 <i class="im im-newspaper-o" aria-hidden="true"></i>
                            </p>
                        </div>
                    </div>
                    <div class="blog-content__all">
                        <a class="open-popup btn btn--primary ">&nbsp;&nbsp;Subscribe&nbsp;&nbsp;&nbsp;</a>
                    </div>
                </div>
                <!-- end Mail-list-subscribe -->

                <!--Pagination-->
                <div id="article-inner-neighbor-pages" class="blog-content__pagenav">
                    <div class="blog-content__nav">
                        <div class="blog-content__prev">
                            <a href="https://leemeng.tw/gpt2-language-model-generate-chinese-jing-yong-novels.html" rel="prev">
                                <span>Previous Post</span>
                                直觀理解 GPT-2 語言模型並生成金庸武俠小說
                            </a>
                        </div>
                        <div class="blog-content__next">
                            <a href="https://leemeng.tw/attack_on_bert_transfer_learning_in_nlp.html" rel="next">
                                <span>Next Post</span>
                                進擊的 BERT：NLP 界的巨人之力與遷移學習
                            </a>
                        </div>
                    </div>

                    <div class="blog-content__all">
                        <a href="blog.html" class="btn btn--primary">
                            View All Post
                        </a>
                    </div>
                </div>
                <!-- end Pagination-->

            </div><!-- end blog-content__main -->


        </div>
        </div> <!-- end blog-content -->

    </article>

<div class="comments-wrap">
    <div id="comments" class="row">
        <div class="col-full">
            <div id="disqus_thread"></div>
        </div>
    </div>
</div>

<script type="text/javascript">
var disqus_shortname = 'leemengtaiwan';
var disqus_title = '資料科學家的 pandas 實戰手冊：掌握 40 個實用數據技巧';

(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


<!-- footer
================================================== -->
<footer style="background:#0a0809">
    <div class="row">
        <div class="col-full">

            <div class="footer-logo">
                <a class="footer-site-logo" href="#0"><img src="https://leemeng.tw/theme/images/logo.png" alt="Homepage"></a>
            </div>

            <ul class="footer-social">
<li><a href="https://github.com/leemengtaiwan" target="_blank">
    <i class="im im-github" aria-hidden="true"></i>
    <span>Github</span>
</a></li>
<li><a href="https://www.facebook.com/LeeMengTaiwan" target="_blank">
    <i class="im im-facebook" aria-hidden="true"></i>
    <span>Facebook</span>
</a></li>
<li><a href="https://www.instagram.com/leemengtaiwan/" target="_blank">
    <i class="im im-instagram" aria-hidden="true"></i>
    <span>Instagram</span>
</a></li>
<li><a href="https://www.linkedin.com/in/leemeng1990/" target="_blank">
    <i class="im im-linkedin" aria-hidden="true"></i>
    <span>LinkedIn</span>
</a></li>            </ul>
        </div>
    </div>
    <div class="row footer-bottom">
        <div class="col-twelve">
            <div class="go-top">
            <a class="smoothscroll" title="Back to Top" href="#top"><i class="im im-arrow-up" aria-hidden="true"></i></a>
            </div>
        </div>
    </div> <!-- end footer-bottom -->
</footer> <!-- end footer -->


        <!-- Javascript
    ================================================== -->
    <script src="https://leemeng.tw/theme/js/jquery-3.2.1.min.js"></script>
    <script src="https://leemeng.tw/theme/js/plugins.js"></script>
    <script src="https://leemeng.tw/theme/js/main_raw.js"></script>
    <script type='text/javascript' src='https://leemeng.tw/theme/js/scroll-detect.js'></script>

    <!--https://instant.page/-->
    <script src="//instant.page/1.0.0" type="module" integrity="sha384-6w2SekMzCkuMQ9sEbq0cLviD/yR2HfA/+ekmKiBnFlsoSvb/VmQFSi/umVShadQI"></script>


    <script type='text/javascript' src='https://leemeng.tw/theme/js/progress-bar.js'></script>
    <script type='text/javascript' src='https://leemeng.tw/theme/js/scroll-detect.js'></script>

    <!--show and hide left navigation by scrolling-->
    <script>
    $(document).scroll(function() {
        var y = $(this).scrollTop();
      if ( $(window).width() > 980 ) {
        if (y > 600) {
          $('#left-navigation').fadeIn(300);
        } else {
          $('#left-navigation').fadeOut(300);
        }
      }
    });
    </script>

<!--reference: https://gist.github.com/scottmagdalein/259d878ad46ed6f2cdce-->
<script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false">
</script>

<script type="text/javascript">
  function showMailingPopUp() {
    require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us18.list-manage.com","uuid":"151cb59f2de814c499c76b77a","lid":"dd1d78cc5e"})})
    document.cookie = "MCPopupClosed=; expires=Thu, 01 Jan 1970 00:00:00 UTC";
    document.cookie = "MCPopupSubscribed=; expires=Thu, 01 Jan 1970 00:00:00 UTC";
  };

  $(function() {
    $(".open-popup").on('click', function() {
      showMailingPopUp();
    });
  });
</script><!--https://darkmodejs.learn.uno/-->
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.4.0/lib/darkmode-js.min.js"></script>
<script>
var options = {
  bottom: '32px', // default: '32px'
  right: 'unset', // default: '32px'
  left: '32px', // default: 'unset'
  time: '0.2s', // default: '0.3s'
  mixColor: '#fff', // default: '#fff'
  backgroundColor: '#fff',  // default: '#fff'
  buttonColorDark: '#100f2c',  // default: '#100f2c'
  buttonColorLight: '#fff', // default: '#fff'
  saveInCookies: true, // default: true,
  label: '🌓', // default: ''
  autoMatchOsTheme: true // default: true
}

const darkmode = new Darkmode(options);
darkmode.showWidget();
</script>
<!--reference: https://www.w3schools.com/howto/tryit.asp?filename=tryhow_js_overlay-->
<script>
function openTocNav() {
    document.getElementById("tocNav").style.width = "100%";
}

function closeTocNav() {
    document.getElementById("tocNav").style.width = "0%";
}

function toggleTocNav() {
    var current_width = document.getElementById("tocNav").style.width;
    if (current_width == "100%") {
        document.getElementById("tocNav").style.width = "0%";
    } else {
        document.getElementById("tocNav").style.width = "100%";
    }
}

function closeLeftNavImage(elementId) {
    document.getElementById(elementId).style.width = "0%";
}

function toggleLeftNavImage(elementId) {
    var current_width = document.getElementById(elementId).style.width;
    if (current_width == "100%") {
        document.getElementById(elementId).style.width = "0%";
    } else {
        document.getElementById(elementId).style.width = "100%";
    }
}

</script>


</body>
</html>